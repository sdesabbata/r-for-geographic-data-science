<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Solutions | R for Geographic Data Science</title>
<meta name="author" content="Stefano De Sabbata">
<meta name="description" content="Print this chapter Solutions 101 Note that you can add sections to your code, such as the “Intro” section below by selecting Code &gt; Insert Section… from the top menu in RStudio. Those will then be...">
<meta name="generator" content="bookdown 0.29 with bs4_book()">
<meta property="og:title" content="Solutions | R for Geographic Data Science">
<meta property="og:type" content="book">
<meta property="og:url" content="https://sdesabbata.github.io/r-for-geographic-data-science/solutions.html">
<meta property="og:image" content="https://sdesabbata.github.io/r-for-geographic-data-science/images/r-for-geographic-data-science-cover.png">
<meta property="og:description" content="Print this chapter Solutions 101 Note that you can add sections to your code, such as the “Intro” section below by selecting Code &gt; Insert Section… from the top menu in RStudio. Those will then be...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Solutions | R for Geographic Data Science">
<meta name="twitter:description" content="Print this chapter Solutions 101 Note that you can add sections to your code, such as the “Intro” section below by selecting Code &gt; Insert Section… from the top menu in RStudio. Those will then be...">
<meta name="twitter:image" content="https://sdesabbata.github.io/r-for-geographic-data-science/images/r-for-geographic-data-science-cover.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.1/transition.js"></script><script src="libs/bs3compat-0.4.1/tabs.js"></script><script src="libs/bs3compat-0.4.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-2Y0M0936JL"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-2Y0M0936JL');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">R for Geographic Data Science</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li class="book-part">Getting started</li>
<li><a class="" href="introduction-to-r.html"><span class="header-section-number">1</span> Introduction to R</a></li>
<li><a class="" href="reproducible-data-science.html"><span class="header-section-number">2</span> Reproducible data science</a></li>
<li><a class="" href="data-manipulation.html"><span class="header-section-number">3</span> Data manipulation</a></li>
<li><a class="" href="table-operations.html"><span class="header-section-number">4</span> Table operations</a></li>
<li class="book-part">Data analysis</li>
<li><a class="" href="exploratory-visualisation.html"><span class="header-section-number">5</span> Exploratory visualisation</a></li>
<li><a class="" href="exploratory-statistics.html"><span class="header-section-number">6</span> Exploratory statistics</a></li>
<li><a class="" href="comparing-data.html"><span class="header-section-number">7</span> Comparing data</a></li>
<li><a class="" href="regression-analysis.html"><span class="header-section-number">8</span> Regression analysis</a></li>
<li class="book-part">Machine learning</li>
<li><a class="" href="supervised-machine-learning.html"><span class="header-section-number">9</span> Supervised machine learning</a></li>
<li><a class="" href="unsupervised-machine-learning.html"><span class="header-section-number">10</span> Unsupervised machine learning</a></li>
<li class="book-part">R scripting</li>
<li><a class="" href="control-structures.html"><span class="header-section-number">11</span> Control structures</a></li>
<li><a class="" href="working-with-functions.html"><span class="header-section-number">12</span> Working with functions</a></li>
<li class="book-part">Appendices</li>
<li><a class="" href="appendix-1.html">Appendix 1</a></li>
<li><a class="active" href="solutions.html">Solutions</a></li>
<li><a class="" href="lecture-slides.html">Lecture slides</a></li>
<li><a class="" href="reading-list.html">Reading list</a></li>
<li><a class="" href="references-1.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/sdesabbata/r-for-geographic-data-science">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="solutions" class="section level1 unnumbered">
<h1>Solutions<a class="anchor" aria-label="anchor" href="#solutions"><i class="fas fa-link"></i></a>
</h1>
<p><br><small><a href="javascript:if(window.print)window.print()">Print this chapter</a></small></p>
<div id="solutions-101" class="section level2 unnumbered">
<h2>Solutions 101<a class="anchor" aria-label="anchor" href="#solutions-101"><i class="fas fa-link"></i></a>
</h2>
<p>Note that you can add sections to your code, such as the “Intro” section below by selecting Code &gt; Insert Section… from the top menu in RStudio. Those will then be visible on a right panel in the RStudio integrated editor if you select Code &gt; Show Document Outline from the top menu. Code sections can help to visually organise your code and the Document Outline allows you to select a section and jump to it in the code.</p>
<p>The code below deletes all variable and function currently defined in the environment, which is generally good practice, to avoid your script interacting with objects left over from previous sessions.</p>
<div class="sourceCode" id="cb424"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Load the necessary libraries.</p>
<div class="sourceCode" id="cb425"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the tidyverse</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load magrittr</span></span>
<span><span class="co"># necessary for options 3 and 4 </span></span>
<span><span class="co"># of my answer to Question 101.2.4</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org">magrittr</a></span><span class="op">)</span></span></code></pre></div>
<div id="solutions-101.1" class="section level3 unnumbered">
<h3>Solutions 101.1<a class="anchor" aria-label="anchor" href="#solutions-101.1"><i class="fas fa-link"></i></a>
</h3>
<p><strong>Question 101.1.1:</strong> Write a piece of code using the pipe operator that takes as input the number <code>1632</code>, calculates the logarithm to the base 10, takes the highest integer number lower than the calculated value (lower round), and verifies whether it is an integer.</p>
<div class="sourceCode" id="cb426"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">1632</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># calculate the logarithm to the base 10</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># highest integer number lower than the value</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html">floor</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># check whether it is an integer</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/integer.html">is.integer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="co"># The answer is FALSE</span></span>
<span>  <span class="co"># as the value is still of type numeric</span></span>
<span>  <span class="co"># rather than type integer</span></span></code></pre></div>
<div class="sourceCode" id="cb427"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The code below replicates the procedure above</span></span>
<span><span class="co"># but checking the value data type</span></span>
<span><span class="fl">1632</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html">floor</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb428"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The code below replicates the procedure above</span></span>
<span><span class="co"># but using as.integer to transfor the value</span></span>
<span><span class="co"># to an integer type</span></span>
<span><span class="fl">1632</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html">floor</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb429"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># As above but checking whether the value is an integer</span></span>
<span><span class="fl">1632</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html">floor</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/integer.html">is.integer</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><strong>Question 101.1.2:</strong> Write a piece of code using the pipe operator that takes as input the number <code>1632</code>, calculates the square root, takes the lowest integer number higher than the calculated value (higher round), and verifies whether it is an integer.</p>
<div class="sourceCode" id="cb430"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">1632</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># calculate the square root</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># lowest integer number higher than the value</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html">ceiling</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># check whether it is an integer</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/integer.html">is.integer</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><strong>Question 101.1.3:</strong> Write a piece of code using the pipe operator that takes as input the string <code>"1632"</code>, transforms it into a number, and checks whether the result is <em>Not a Number</em>.</p>
<div class="sourceCode" id="cb431"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="st">"1632"</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># transform it into a number</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># check whether the result is Not a Number</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/is.finite.html">is.nan</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><strong>Question 101.1.4:</strong> Write a piece of code using the pipe operator that takes as input the string <code>"-16.32"</code>, transforms it into a number, takes the absolute value and truncates it, and finally checks whether the result is <em>Not Available</em>.</p>
<div class="sourceCode" id="cb432"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="st">"-16.32"</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># transform it into a number</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># take the absolute value</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># truncate</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html">trunc</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># check whether the result is Not Available</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><strong>Question 101.1.5:</strong> Rewrite a piece of code below by substituting the last line with the function <code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code>. What kind of result do you obtain? What does it represent?</p>
<div class="sourceCode" id="cb433"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">iris</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">Petal.Length</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>The output is a numeric value representing the aritmetic mean (average) of all the petal lengths of flowers in the <code>iris</code> dataset.</p>
<p><strong>Question 101.1.6:</strong> Further edit the code created for <em>Question 101.1.6</em> by substituting <code>Petal.Length</code> with <code>Petal.Width</code> first and <code>Species</code> then? What kind of results do you obtain? What do they mean?</p>
<div class="sourceCode" id="cb434"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">iris</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">Petal.Width</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">iris</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">Species</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div id="solutions-102" class="section level2 unnumbered">
<h2>Solutions 102<a class="anchor" aria-label="anchor" href="#solutions-102"><i class="fas fa-link"></i></a>
</h2>
<div id="solutions-102.1" class="section level3 unnumbered">
<h3>Solutions 102.1<a class="anchor" aria-label="anchor" href="#solutions-102.1"><i class="fas fa-link"></i></a>
</h3>
<p>Extend the code in the script <code>practical-102_my-script-002.R</code> to include the code necessary to solve the questions below.</p>
<div class="sourceCode" id="cb435"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/nycflights13">nycflights13</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/">knitr</a></span><span class="op">)</span></span></code></pre></div>
<p><strong>Question 101.1.1:</strong> Write a piece of code using the pipe operator and the <code>dplyr</code> library to generate a table showing the air time and the carrier, but only for flights starting from the JFK airport. As in the examples above, use <code>slice_head</code> and <code>kable</code> to output a nicely-formatted table containing only the first 10 rows.</p>
<div class="sourceCode" id="cb436"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Start from the entire dataset</span></span>
<span><span class="va">flights</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Retain only the necessary columns</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">origin</span>, <span class="va">carrier</span>, <span class="va">air_time</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Retain only rows representing flights from JFK</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">origin</span> <span class="op">==</span> <span class="st">"JFK"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left">origin</th>
<th align="left">carrier</th>
<th align="right">air_time</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">JFK</td>
<td align="left">AA</td>
<td align="right">160</td>
</tr>
<tr class="even">
<td align="left">JFK</td>
<td align="left">B6</td>
<td align="right">183</td>
</tr>
<tr class="odd">
<td align="left">JFK</td>
<td align="left">B6</td>
<td align="right">140</td>
</tr>
<tr class="even">
<td align="left">JFK</td>
<td align="left">B6</td>
<td align="right">149</td>
</tr>
<tr class="odd">
<td align="left">JFK</td>
<td align="left">B6</td>
<td align="right">158</td>
</tr>
</tbody>
</table></div>
<p><strong>Question 102.1.2:</strong> Write a piece of code using the pipe operator and the <code>dplyr</code> library to generate a table showing the arrival delay and the overall air time, but only for flights of October 12th. As in the examples above, use <code>slice_head</code> and <code>kable</code> to output a nicely-formatted table containing only the first 10 rows.</p>
<div class="sourceCode" id="cb437"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Start from the entire dataset</span></span>
<span><span class="va">flights</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Retain only the necessary columns</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">year</span><span class="op">:</span><span class="va">day</span>, <span class="va">arr_delay</span>, <span class="va">air_time</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Retain only rows where month equals 10 and day equals 12</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">month</span> <span class="op">==</span> <span class="fl">10</span> <span class="op">&amp;</span> <span class="va">day</span> <span class="op">==</span> <span class="fl">12</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="right">year</th>
<th align="right">month</th>
<th align="right">day</th>
<th align="right">arr_delay</th>
<th align="right">air_time</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">2013</td>
<td align="right">10</td>
<td align="right">12</td>
<td align="right">-20</td>
<td align="right">74</td>
</tr>
<tr class="even">
<td align="right">2013</td>
<td align="right">10</td>
<td align="right">12</td>
<td align="right">-27</td>
<td align="right">181</td>
</tr>
<tr class="odd">
<td align="right">2013</td>
<td align="right">10</td>
<td align="right">12</td>
<td align="right">-30</td>
<td align="right">142</td>
</tr>
<tr class="even">
<td align="right">2013</td>
<td align="right">10</td>
<td align="right">12</td>
<td align="right">-10</td>
<td align="right">193</td>
</tr>
<tr class="odd">
<td align="right">2013</td>
<td align="right">10</td>
<td align="right">12</td>
<td align="right">17</td>
<td align="right">210</td>
</tr>
</tbody>
</table></div>
<p><strong>Question 102.1.3:</strong> Write a piece of code using the pipe operator and the <code>dplyr</code> library to generate a table showing the arrival delay, origin and destination, but only for flight leaving between 11am and 2pm. As in the examples above, use <code>slice_head</code> and <code>kable</code> to output a nicely-formatted table containing only the first 10 rows.</p>
<div class="sourceCode" id="cb438"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Start from the entire dataset</span></span>
<span><span class="va">flights</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Retain only the necessary columns</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">origin</span>, <span class="va">dest</span>, <span class="va">dep_time</span>, <span class="va">arr_delay</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Retain only rows where departure time is greater than or equal to 1100</span></span>
<span>  <span class="co"># and departure time is also less than or equal to 1100</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">dep_time</span> <span class="op">&gt;=</span> <span class="fl">1100</span> <span class="op">&amp;</span> <span class="va">dep_time</span> <span class="op">&lt;=</span> <span class="fl">1400</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left">origin</th>
<th align="left">dest</th>
<th align="right">dep_time</th>
<th align="right">arr_delay</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">EWR</td>
<td align="left">PBI</td>
<td align="right">1101</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="left">LGA</td>
<td align="left">MIA</td>
<td align="right">1103</td>
<td align="right">-11</td>
</tr>
<tr class="odd">
<td align="left">EWR</td>
<td align="left">SFO</td>
<td align="right">1105</td>
<td align="right">23</td>
</tr>
<tr class="even">
<td align="left">LGA</td>
<td align="left">CMH</td>
<td align="right">1107</td>
<td align="right">-5</td>
</tr>
<tr class="odd">
<td align="left">LGA</td>
<td align="left">MIA</td>
<td align="right">1109</td>
<td align="right">-23</td>
</tr>
</tbody>
</table></div>
</div>
</div>
<div id="solutions-103" class="section level2 unnumbered">
<h2>Solutions 103<a class="anchor" aria-label="anchor" href="#solutions-103"><i class="fas fa-link"></i></a>
</h2>
<div id="solutions-103.1" class="section level3 unnumbered">
<h3>Solutions 103.1<a class="anchor" aria-label="anchor" href="#solutions-103.1"><i class="fas fa-link"></i></a>
</h3>
<p>Create an RMarkdown document in RStudio, using <em>Exercise 103</em> as title and <em>PDF</em> as output. Delete all the contents except the first five lines which compose the heading. Save the document as <code>practical-103_exercises.Rmd</code>. Add the libraries and code necessary to read the data from the <code>2011_OAC_Raw_uVariables_Leicester.csv</code> file. Create a first section of the document (e.g., adding a second heading <em>Exercise 103.1</em>) and add your answers to the questions below.</p>
<p>In order to answer the questions below, inspect the <strong>look-up</strong> table <code>2011_OAC_Raw_uVariables_Lookup.csv</code> (e.g., using Microsoft Excel) to identify the columns necessary to complete the task.</p>
<p><strong>Question 103.1.1:</strong> Identify the five variables which are part of the variable subdomain <em>Housing Type</em> and write the code necessary to compute the total number of household spaces in Leicester for each housing type.</p>
<div class="sourceCode" id="cb439"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leicester_2011OAC</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>    u086_tot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">u086</span><span class="op">)</span>,</span>
<span>    u087_tot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">u087</span><span class="op">)</span>,</span>
<span>    u088_tot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">u088</span><span class="op">)</span>,</span>
<span>    u089_tot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">u089</span><span class="op">)</span>,</span>
<span>    u090_tot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">u090</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="right">u086_tot</th>
<th align="right">u087_tot</th>
<th align="right">u088_tot</th>
<th align="right">u089_tot</th>
<th align="right">u090_tot</th>
</tr></thead>
<tbody><tr class="odd">
<td align="right">13390</td>
<td align="right">44880</td>
<td align="right">40290</td>
<td align="right">28757</td>
<td align="right">66</td>
</tr></tbody>
</table></div>
<p><strong>Question 103.1.2:</strong> Write the code necessary to compute the total number of household spaces in Leicester for each housing type grouped by 2011 OAC supergroup.</p>
<div class="sourceCode" id="cb440"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leicester_2011OAC</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">supgrpname</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>    u086_tot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">u086</span><span class="op">)</span>,</span>
<span>    u087_tot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">u087</span><span class="op">)</span>,</span>
<span>    u088_tot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">u088</span><span class="op">)</span>,</span>
<span>    u089_tot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">u089</span><span class="op">)</span>,</span>
<span>    u090_tot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">u090</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table style="width:100%;" class="table table-sm">
<colgroup>
<col width="38%">
<col width="12%">
<col width="12%">
<col width="12%">
<col width="12%">
<col width="12%">
</colgroup>
<thead><tr class="header">
<th align="left">supgrpname</th>
<th align="right">u086_tot</th>
<th align="right">u087_tot</th>
<th align="right">u088_tot</th>
<th align="right">u089_tot</th>
<th align="right">u090_tot</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Constrained City Dwellers</td>
<td align="right">176</td>
<td align="right">1495</td>
<td align="right">941</td>
<td align="right">1876</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">Cosmopolitans</td>
<td align="right">296</td>
<td align="right">580</td>
<td align="right">3185</td>
<td align="right">7261</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">Ethnicity Central</td>
<td align="right">187</td>
<td align="right">465</td>
<td align="right">1292</td>
<td align="right">7093</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="left">Hard-Pressed Living</td>
<td align="right">618</td>
<td align="right">7825</td>
<td align="right">3891</td>
<td align="right">370</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="left">Multicultural Metropolitans</td>
<td align="right">7700</td>
<td align="right">26940</td>
<td align="right">28804</td>
<td align="right">10990</td>
<td align="right">40</td>
</tr>
<tr class="even">
<td align="left">Suburbanites</td>
<td align="right">2458</td>
<td align="right">3852</td>
<td align="right">210</td>
<td align="right">111</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">Urbanites</td>
<td align="right">1955</td>
<td align="right">3723</td>
<td align="right">1967</td>
<td align="right">1056</td>
<td align="right">1</td>
</tr>
</tbody>
</table></div>
<p><strong>Question 103.1.3:</strong> Write the code necessary to compute the percentage of household spaces (i.e., over to the total number of household spaces) in Leicester for each housing type grouped by 2011 OAC supergroup.</p>
<div class="sourceCode" id="cb441"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leicester_2011OAC</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">supgrpname</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>    u086_tot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">u086</span><span class="op">)</span>,</span>
<span>    u087_tot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">u087</span><span class="op">)</span>,</span>
<span>    u088_tot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">u088</span><span class="op">)</span>,</span>
<span>    u089_tot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">u089</span><span class="op">)</span>,</span>
<span>    u090_tot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">u090</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    tot_hspaces <span class="op">=</span> </span>
<span>      <span class="va">u086_tot</span> <span class="op">+</span> <span class="va">u087_tot</span> <span class="op">+</span></span>
<span>      <span class="va">u088_tot</span> <span class="op">+</span> <span class="va">u089_tot</span> <span class="op">+</span></span>
<span>      <span class="va">u090_tot</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    u086_perc <span class="op">=</span> <span class="op">(</span><span class="va">u086_tot</span> <span class="op">/</span> <span class="va">tot_hspaces</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>,</span>
<span>    u087_perc <span class="op">=</span> <span class="op">(</span><span class="va">u087_tot</span> <span class="op">/</span> <span class="va">tot_hspaces</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>,</span>
<span>    u088_perc <span class="op">=</span> <span class="op">(</span><span class="va">u088_tot</span> <span class="op">/</span> <span class="va">tot_hspaces</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>,</span>
<span>    u089_perc <span class="op">=</span> <span class="op">(</span><span class="va">u089_tot</span> <span class="op">/</span> <span class="va">tot_hspaces</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>,</span>
<span>    u090_perc <span class="op">=</span> <span class="op">(</span><span class="va">u090_tot</span> <span class="op">/</span> <span class="va">tot_hspaces</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span></span>
<span>    <span class="va">supgrpname</span>,</span>
<span>    <span class="va">u086_perc</span>, <span class="va">u087_perc</span>, <span class="va">u088_perc</span>,</span>
<span>    <span class="va">u089_perc</span>, <span class="va">u090_perc</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="35%">
<col width="12%">
<col width="12%">
<col width="12%">
<col width="12%">
<col width="12%">
</colgroup>
<thead><tr class="header">
<th align="left">supgrpname</th>
<th align="right">u086_perc</th>
<th align="right">u087_perc</th>
<th align="right">u088_perc</th>
<th align="right">u089_perc</th>
<th align="right">u090_perc</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Constrained City Dwellers</td>
<td align="right">3.92</td>
<td align="right">33.29</td>
<td align="right">20.95</td>
<td align="right">41.77</td>
<td align="right">0.07</td>
</tr>
<tr class="even">
<td align="left">Cosmopolitans</td>
<td align="right">2.61</td>
<td align="right">5.12</td>
<td align="right">28.12</td>
<td align="right">64.11</td>
<td align="right">0.03</td>
</tr>
<tr class="odd">
<td align="left">Ethnicity Central</td>
<td align="right">2.07</td>
<td align="right">5.14</td>
<td align="right">14.29</td>
<td align="right">78.44</td>
<td align="right">0.07</td>
</tr>
<tr class="even">
<td align="left">Hard-Pressed Living</td>
<td align="right">4.86</td>
<td align="right">61.53</td>
<td align="right">30.60</td>
<td align="right">2.91</td>
<td align="right">0.10</td>
</tr>
<tr class="odd">
<td align="left">Multicultural Metropolitans</td>
<td align="right">10.34</td>
<td align="right">36.17</td>
<td align="right">38.68</td>
<td align="right">14.76</td>
<td align="right">0.05</td>
</tr>
<tr class="even">
<td align="left">Suburbanites</td>
<td align="right">37.07</td>
<td align="right">58.09</td>
<td align="right">3.17</td>
<td align="right">1.67</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">Urbanites</td>
<td align="right">22.47</td>
<td align="right">42.78</td>
<td align="right">22.60</td>
<td align="right">12.14</td>
<td align="right">0.01</td>
</tr>
</tbody>
</table></div>
<p><strong>Question 103.1.4:</strong> Modify the code written for <em>Question 103.1.3</em>, using <a href="">the verb <code>rename</code></a> to change the column names of the columns containing the percentages to names that resemble the related housing type (e.g., <code>perc_of_detached</code>).</p>
</div>
</div>
<div id="solutions-104" class="section level2 unnumbered">
<h2>Solutions 104<a class="anchor" aria-label="anchor" href="#solutions-104"><i class="fas fa-link"></i></a>
</h2>
<div id="solutions-104.1" class="section level3 unnumbered">
<h3>Solutions 104.1<a class="anchor" aria-label="anchor" href="#solutions-104.1"><i class="fas fa-link"></i></a>
</h3>
<p>Extend the code in the script <code>Data_Wrangling_Example.R</code> (see code below) to include the code necessary to solve the questions below. Use the full list of variable names from the 2011 UK Census used to generate the 2011 OAC thatcan be found in the file <code>2011_OAC_Raw_uVariables_Lookup.csv</code> to indetify which columns to use to complete the tasks.</p>
<div class="sourceCode" id="cb442"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Data_Wrangling_Example.R </span></span>
<span></span>
<span><span class="co"># Load the tidyverse</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load 2011 OAC data</span></span>
<span><span class="va">leicester_2011OAC</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"data/2011_OAC_Raw_uVariables_Leicester.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load Indexes of Multiple deprivation data</span></span>
<span><span class="va">leicester_IMD2015</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"data/IndexesMultipleDeprivation2015_Leicester.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">leicester_IMD2015_decile_wide</span> <span class="op">&lt;-</span> <span class="va">leicester_IMD2015</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Select only Socres</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Measurement</span> <span class="op">==</span> <span class="st">"Decile"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Trim names of IndicesOfDeprivation</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    IndicesOfDeprivation <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace_all</a></span><span class="op">(</span><span class="va">IndicesOfDeprivation</span>, <span class="st">"\\s"</span>, <span class="st">""</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    IndicesOfDeprivation <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace_all</a></span><span class="op">(</span><span class="va">IndicesOfDeprivation</span>, <span class="st">"[:punct:]"</span>, <span class="st">""</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    IndicesOfDeprivation <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace_all</a></span><span class="op">(</span><span class="va">IndicesOfDeprivation</span>, <span class="st">"\\("</span>, <span class="st">""</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    IndicesOfDeprivation <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace_all</a></span><span class="op">(</span><span class="va">IndicesOfDeprivation</span>, <span class="st">"\\)"</span>, <span class="st">""</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Spread</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span></span>
<span>    names_from <span class="op">=</span> <span class="va">IndicesOfDeprivation</span>,</span>
<span>    values_from <span class="op">=</span> <span class="va">Value</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Drop columns</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">DateCode</span>, <span class="op">-</span><span class="va">Measurement</span>, <span class="op">-</span><span class="va">Units</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Join</span></span>
<span><span class="va">leicester_2011OAC_IMD2015</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">leicester_2011OAC</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span></span>
<span>    <span class="va">leicester_IMD2015_decile_wide</span>, </span>
<span>    by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LSOA11CD"</span> <span class="op">=</span> <span class="st">"FeatureCode"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><strong>Question 104.1.1:</strong> Write a piece of code using the pipe operator and the <code>dplyr</code> library to generate a table showing the percentage of EU citizens over total population, calculated grouping OAs by the related decile of the Index of Multiple Deprivations, but only accounting for areas classified as Cosmopolitans or Ethnicity Central or Multicultural Metropolitans.</p>
<div class="sourceCode" id="cb443"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leicester_2011OAC_IMD2015</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">supgrpname</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Cosmopolitans"</span>, <span class="st">"Ethnicity Central"</span>, <span class="st">"Multicultural Metropolitans"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">IndexofMultipleDeprivationIMD</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>    adults_not_empl_perc <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">u044</span> <span class="op">+</span> <span class="va">u045</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">Total_Population</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><strong>Question 104.1.2:</strong> Write a piece of code using the pipe operator and the <code>dplyr</code> library to generate a table showing the percentage of EU citizens over total population, calculated grouping OAs by the related supergroup in the 2011 OAC, but only accounting for areas in the top 5 deciles of the Index of Multiple Deprivations.</p>
<div class="sourceCode" id="cb444"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leicester_2011OAC_IMD2015</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">IndexofMultipleDeprivationIMD</span> <span class="op">&lt;=</span> <span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">supgrpname</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>    eu_perc <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">u043</span> <span class="op">+</span> <span class="va">u044</span> <span class="op">+</span> <span class="va">u045</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">Total_Population</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><strong>Question 104.1.3:</strong> Write a piece of code using the pipe operator and the <code>dplyr</code> library to generate a table showing the percentage of people aged 65 and above, calculated grouping OAs by the related supergroup in the 2011 OAC and decile of the Index of Multiple Deprivations, and ordering the table by the calculated value in a descending order.</p>
<div class="sourceCode" id="cb445"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leicester_2011OAC_IMD2015</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">IndexofMultipleDeprivationIMD</span> <span class="op">&lt;=</span> <span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">supgrpname</span>, <span class="va">IndexofMultipleDeprivationIMD</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>    aged_65_above <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">u016</span> <span class="op">+</span> <span class="va">u017</span> <span class="op">+</span> <span class="va">u018</span> <span class="op">+</span> <span class="va">u019</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">Total_Population</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">aged_65_above</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Extend the code in the script <code>Data_Wrangling_Example.R</code> to include the code necessary to solve the questions below.</p>
<p><strong>Question 104.1.4:</strong> Write a piece of code using the pipe operator and the <code>dplyr</code> and <code>tidyr</code> libraries to generate a long format of the <code>leicester_2011OAC_IMD2015</code> table only including the values (census variables) used in <em>Question 104.1.3</em>.</p>
<div class="sourceCode" id="cb446"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">long_table</span> <span class="op">&lt;-</span> <span class="va">leicester_2011OAC_IMD2015</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">OA11CD</span>, <span class="va">supgrpname</span>, <span class="va">IndexofMultipleDeprivationIMD</span>, <span class="va">u016</span>, <span class="va">u017</span>, <span class="va">u018</span>, <span class="va">u019</span>, <span class="va">Total_Population</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span></span>
<span>    <span class="co"># Can't combine character values (e.g. supgrpname)</span></span>
<span>    <span class="co"># with numeric value (e.g, Total_Population) thus</span></span>
<span>    <span class="co"># pivot only numeric columns</span></span>
<span>    cols <span class="op">=</span> <span class="va">u016</span><span class="op">:</span><span class="va">Total_Population</span>,</span>
<span>    names_to <span class="op">=</span> <span class="st">"attribute"</span>,</span>
<span>    values_to <span class="op">=</span> <span class="st">"value"</span></span>
<span>  <span class="op">)</span> </span>
<span></span>
<span><span class="va">long_table</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">long_table_alt</span> <span class="op">&lt;-</span> <span class="va">leicester_2011OAC_IMD2015</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">OA11CD</span>, <span class="va">supgrpcode</span>, <span class="va">IndexofMultipleDeprivationIMD</span>, <span class="va">u016</span>, <span class="va">u017</span>, <span class="va">u018</span>, <span class="va">u019</span>, <span class="va">Total_Population</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span></span>
<span>    <span class="co"># Otherwise, use supgrpcode instead of supgrpname</span></span>
<span>    cols <span class="op">=</span> <span class="op">-</span><span class="va">OA11CD</span>,</span>
<span>    names_to <span class="op">=</span> <span class="st">"attribute"</span>,</span>
<span>    values_to <span class="op">=</span> <span class="st">"value"</span></span>
<span>  <span class="op">)</span> </span>
<span></span>
<span><span class="va">long_table_alt</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">7</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><strong>Question 104.1.5:</strong> Write a piece of code using the pipe operator and the <code>dplyr</code> and <code>tidyr</code> libraries to generate a table similar to the one generated for <em>Question 104.1.4</em>, but showing the values as percentages over total population.</p>
<div class="sourceCode" id="cb447"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">perc_long_table</span> <span class="op">&lt;-</span> <span class="va">leicester_2011OAC_IMD2015</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">OA11CD</span>, <span class="va">supgrpname</span>, <span class="va">IndexofMultipleDeprivationIMD</span>, <span class="va">u016</span>, <span class="va">u017</span>, <span class="va">u018</span>, <span class="va">u019</span>, <span class="va">Total_Population</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    perc_u016 <span class="op">=</span> <span class="op">(</span><span class="va">u016</span> <span class="op">/</span> <span class="va">Total_Population</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, </span>
<span>    perc_u017 <span class="op">=</span> <span class="op">(</span><span class="va">u017</span> <span class="op">/</span> <span class="va">Total_Population</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, </span>
<span>    perc_u018 <span class="op">=</span> <span class="op">(</span><span class="va">u018</span> <span class="op">/</span> <span class="va">Total_Population</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, </span>
<span>    perc_u019 <span class="op">=</span> <span class="op">(</span><span class="va">u019</span> <span class="op">/</span> <span class="va">Total_Population</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">OA11CD</span>, <span class="va">supgrpname</span>, <span class="va">IndexofMultipleDeprivationIMD</span>, <span class="va">perc_u016</span>, <span class="va">perc_u017</span>, <span class="va">perc_u018</span>, <span class="va">perc_u019</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span></span>
<span>    <span class="co"># Can't combine character values (e.g. supgrpname)</span></span>
<span>    <span class="co"># with numeric value (e.g, Total_Population) thus</span></span>
<span>    <span class="co"># pivot only numeric columns</span></span>
<span>    cols <span class="op">=</span> <span class="va">perc_u016</span><span class="op">:</span><span class="va">perc_u019</span>,</span>
<span>    names_to <span class="op">=</span> <span class="st">"attribute"</span>,</span>
<span>    values_to <span class="op">=</span> <span class="st">"value"</span></span>
<span>  <span class="op">)</span> </span>
<span></span>
<span><span class="va">perc_long_table</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div id="solutions-201" class="section level2 unnumbered">
<h2>Solutions 201<a class="anchor" aria-label="anchor" href="#solutions-201"><i class="fas fa-link"></i></a>
</h2>
<div id="solutions-201.1" class="section level3 unnumbered">
<h3>Solutions 201.1<a class="anchor" aria-label="anchor" href="#solutions-201.1"><i class="fas fa-link"></i></a>
</h3>
<p>Open the <code>Leicester_population</code> project used in previous chapters and extend the <em>“Exploring deprivation indices in Leicester”</em> document to include the code necessary to solve the questions below. Use the full list of variable names from the 2011 UK Census used to generate the 2011 OAC that can be found in the file <code>2011_OAC_Raw_uVariables_Lookup.csv</code> to indetify which columns to use to complete the tasks.</p>
<p><strong>Question 201.1.1:</strong> Write a piece of code to create a chart showing the percentage of EU citizens over total population for each decile of the Index of Multiple Deprivations</p>
<div class="sourceCode" id="cb448"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leicester_2011OAC_IMD2015</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">IndexofMultipleDeprivationIMD</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>    eu_perc <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">u043</span> <span class="op">+</span> <span class="va">u044</span> <span class="op">+</span> <span class="va">u045</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">Total_Population</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">eu_perc</span>,</span>
<span>      <span class="co"># Note that it is necessary to convert the index</span></span>
<span>      <span class="co"># to a factor, otherwise it is interpreted as a number</span></span>
<span>      y <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/as_factor.html">as_factor</a></span><span class="op">(</span><span class="va">IndexofMultipleDeprivationIMD</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Alternatively.</p>
<div class="sourceCode" id="cb449"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leicester_2011OAC_IMD2015</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">IndexofMultipleDeprivationIMD</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>    eu_perc <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">u043</span> <span class="op">+</span> <span class="va">u044</span> <span class="op">+</span> <span class="va">u045</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">Total_Population</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    reminder <span class="op">=</span> <span class="fl">100</span> <span class="op">-</span> <span class="va">eu_perc</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="op">-</span><span class="va">IndexofMultipleDeprivationIMD</span>,</span>
<span>    names_to <span class="op">=</span> <span class="st">"country_of_origin"</span>,</span>
<span>    values_to <span class="op">=</span> <span class="st">"percentage"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">percentage</span>,</span>
<span>      <span class="co"># Note that it is necessary to convert the index</span></span>
<span>      <span class="co"># to a factor, otherwise it is interpreted as a number</span></span>
<span>      y <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/as_factor.html">as_factor</a></span><span class="op">(</span><span class="va">IndexofMultipleDeprivationIMD</span><span class="op">)</span>,</span>
<span>      fill <span class="op">=</span> <span class="va">country_of_origin</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><strong>Question 201.1.2:</strong> Write a piece of code to create a chart showing the relationship between the percentage of EU citizens over total population with the related score of the Index of Multiple Deprivations, and illustrating also the 2011 OAC class of each OA.</p>
<div class="sourceCode" id="cb450"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Use a similar code as used in Exercise 104</span></span>
<span><span class="co"># but filtering in the Scores rather than the deciles</span></span>
<span><span class="va">leicester_IMD2015_score_wide</span> <span class="op">&lt;-</span> <span class="va">leicester_IMD2015</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Select only Socres</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Measurement</span> <span class="op">==</span> <span class="st">"Score"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Trim names of IndicesOfDeprivation</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    IndicesOfDeprivation <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace_all</a></span><span class="op">(</span><span class="va">IndicesOfDeprivation</span>, <span class="st">"\\s"</span>, <span class="st">""</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    IndicesOfDeprivation <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace_all</a></span><span class="op">(</span><span class="va">IndicesOfDeprivation</span>, <span class="st">"[:punct:]"</span>, <span class="st">""</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    IndicesOfDeprivation <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace_all</a></span><span class="op">(</span><span class="va">IndicesOfDeprivation</span>, <span class="st">"\\("</span>, <span class="st">""</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    IndicesOfDeprivation <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace_all</a></span><span class="op">(</span><span class="va">IndicesOfDeprivation</span>, <span class="st">"\\)"</span>, <span class="st">""</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Spread</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span></span>
<span>    names_from <span class="op">=</span> <span class="va">IndicesOfDeprivation</span>,</span>
<span>    values_from <span class="op">=</span> <span class="va">Value</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Drop columns</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">DateCode</span>, <span class="op">-</span><span class="va">Measurement</span>, <span class="op">-</span><span class="va">Units</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Join</span></span>
<span><span class="va">leicester_2011OAC_IMD2015_score</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">leicester_2011OAC</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span></span>
<span>    <span class="va">leicester_IMD2015_score_wide</span>, </span>
<span>    by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LSOA11CD"</span> <span class="op">=</span> <span class="st">"FeatureCode"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">leicester_2011OAC_IMD2015_score</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    eu_perc <span class="op">=</span> <span class="op">(</span><span class="op">(</span><span class="va">u043</span> <span class="op">+</span> <span class="va">u044</span> <span class="op">+</span> <span class="va">u045</span><span class="op">)</span> <span class="op">/</span> <span class="va">Total_Population</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">eu_perc</span>,</span>
<span>      y <span class="op">=</span> <span class="va">IndexofMultipleDeprivationIMD</span>,</span>
<span>      colour <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_reorder.html">fct_reorder</a></span><span class="op">(</span><span class="va">supgrpname</span>, <span class="va">supgrpcode</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#e41a1c"</span>, <span class="st">"#f781bf"</span>, <span class="st">"#ff7f00"</span>, <span class="st">"#a65628"</span>, <span class="st">"#984ea3"</span>, <span class="st">"#377eb8"</span>, <span class="st">"#ffff33"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><strong>Question 201.1.3:</strong> Write a piece of code to create a chart showing the relationship between the percentage of people aged 65 and above with the related score of the Income Deprivation, and illustrating also the 2011 OAC class of each OA.</p>
<div class="sourceCode" id="cb451"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leicester_2011OAC_IMD2015_score</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    aged_65_above <span class="op">=</span> <span class="op">(</span><span class="op">(</span><span class="va">u016</span> <span class="op">+</span> <span class="va">u017</span> <span class="op">+</span> <span class="va">u018</span> <span class="op">+</span> <span class="va">u019</span><span class="op">)</span> <span class="op">/</span> <span class="va">Total_Population</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">aged_65_above</span>,</span>
<span>      y <span class="op">=</span> <span class="va">LivingEnvironmentDeprivationDomain</span>,</span>
<span>      colour <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_reorder.html">fct_reorder</a></span><span class="op">(</span><span class="va">supgrpname</span>, <span class="va">supgrpcode</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#e41a1c"</span>, <span class="st">"#f781bf"</span>, <span class="st">"#ff7f00"</span>, <span class="st">"#a65628"</span>, <span class="st">"#984ea3"</span>, <span class="st">"#377eb8"</span>, <span class="st">"#ffff33"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><strong>Question 201.1.4:</strong> What does the graph produced for <em>Question 201.1.3</em> mean? Write up to 100 words explaining what conclusions can be drawn from the graph – remember that <a href="https://assets.publishing.service.gov.uk/government/uploads/system/uploads/attachment_data/file/853811/IoD2019_FAQ_v4.pdf"><em>“the larger the score, the more deprived the area”</em></a>.</p>
<p><strong>Question 201.1.5:</strong> Identify the index of multiple deprivation that most closely relate to the percentage of people per OA whose <em>“day-to-day activities limited a lot or a little”</em> based on the <em>“Standardised Illness Ratio”</em>.</p>
</div>
</div>
<div id="solutions-202" class="section level2 unnumbered">
<h2>Solutions 202<a class="anchor" aria-label="anchor" href="#solutions-202"><i class="fas fa-link"></i></a>
</h2>
<div id="solutions-202.1" class="section level3 unnumbered">
<h3>Solutions 202.1<a class="anchor" aria-label="anchor" href="#solutions-202.1"><i class="fas fa-link"></i></a>
</h3>
<p>Create a new RMarkdown document, and add the code necessary to recreate the table <code>leic_2011OAC_20to24</code> used in the example above. Use the code below to re-shape the table <code>leic_2011OAC_20to24</code> by pivoting the <code>perc_age_20_to_24</code> column wider into multiple columns using <code>supgrpname</code> as new column names.</p>
<div class="sourceCode" id="cb452"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leic_2011OAC_20to24_supgrp</span> <span class="op">&lt;-</span> <span class="va">leic_2011OAC_20to24</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span></span>
<span>    names_from <span class="op">=</span> <span class="va">supgrpname</span>,</span>
<span>    values_from <span class="op">=</span> <span class="va">perc_age_20_to_24</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>That manipulation creates one column per supergroup, containing the <code>perc_age_20_to_24</code> if the OA is part of that supergroup, or an <code>NA</code> value if the OA is not part of the supergroup. The transformation is illustrated in the two tables below. The first shows an extract from the original <code>leic_2011OAC_20to24</code> dataset, followed by the wide version <code>leic_2011OAC_20to24_supgrp</code>.</p>
<div class="sourceCode" id="cb453"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leic_2011OAC_20to24</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_min</a></span><span class="op">(</span><span class="va">OA11CD</span>, n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left">OA11CD</th>
<th align="left">supgrpname</th>
<th align="right">perc_age_20_to_24</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">E00068657</td>
<td align="left">HP</td>
<td align="right">6.053</td>
</tr>
<tr class="even">
<td align="left">E00068658</td>
<td align="left">MM</td>
<td align="right">6.964</td>
</tr>
<tr class="odd">
<td align="left">E00068659</td>
<td align="left">MM</td>
<td align="right">8.383</td>
</tr>
<tr class="even">
<td align="left">E00068660</td>
<td align="left">MM</td>
<td align="right">4.643</td>
</tr>
<tr class="odd">
<td align="left">E00068661</td>
<td align="left">MM</td>
<td align="right">10.625</td>
</tr>
<tr class="even">
<td align="left">E00068662</td>
<td align="left">MM</td>
<td align="right">8.284</td>
</tr>
<tr class="odd">
<td align="left">E00068663</td>
<td align="left">MM</td>
<td align="right">8.357</td>
</tr>
<tr class="even">
<td align="left">E00068664</td>
<td align="left">MM</td>
<td align="right">3.597</td>
</tr>
<tr class="odd">
<td align="left">E00068665</td>
<td align="left">MM</td>
<td align="right">7.068</td>
</tr>
<tr class="even">
<td align="left">E00068666</td>
<td align="left">MM</td>
<td align="right">5.864</td>
</tr>
</tbody>
</table></div>
<div class="sourceCode" id="cb454"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leic_2011OAC_20to24_supgrp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_min</a></span><span class="op">(</span><span class="va">OA11CD</span>, n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left">OA11CD</th>
<th align="right">SU</th>
<th align="right">CP</th>
<th align="right">MM</th>
<th align="right">EC</th>
<th align="right">CD</th>
<th align="right">HP</th>
<th align="right">UR</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">E00068657</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">6.053</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">E00068658</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">6.964</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">E00068659</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">8.383</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">E00068660</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">4.643</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">E00068661</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">10.625</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">E00068662</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">8.284</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">E00068663</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">8.357</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">E00068664</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">3.597</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">E00068665</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">7.068</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">E00068666</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">5.864</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
</tbody>
</table></div>
<p><strong>Question 202.1.1:</strong> The code below uses the newly created <code>leic_2011OAC_20to24_supgrp</code> table to calculate the descriptive statistics calculated for the variable <code>leic_2011OAC_20to24</code> for each supergroup. Is <code>leic_2011OAC_20to24</code> normally distributed in any of the subgroups? If yes, which supergroups and based on which values do you justify that claim? (Write up to 200 words)</p>
<div class="sourceCode" id="cb455"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leic_2011OAC_20to24_supgrp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">OA11CD</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pastecs/man/stat.desc.html">stat.desc</a></span><span class="op">(</span>norm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table style="width:100%;" class="table table-sm">
<colgroup>
<col width="18%">
<col width="11%">
<col width="12%">
<col width="12%">
<col width="11%">
<col width="11%">
<col width="11%">
<col width="11%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="right">SU</th>
<th align="right">CP</th>
<th align="right">MM</th>
<th align="right">EC</th>
<th align="right">CD</th>
<th align="right">HP</th>
<th align="right">UR</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">nbr.val</td>
<td align="right">54.000</td>
<td align="right">83.000</td>
<td align="right">573.000</td>
<td align="right">57.000</td>
<td align="right">36.000</td>
<td align="right">101.000</td>
<td align="right">65.000</td>
</tr>
<tr class="even">
<td align="left">nbr.null</td>
<td align="right">0.000</td>
<td align="right">0.000</td>
<td align="right">0.000</td>
<td align="right">0.000</td>
<td align="right">0.000</td>
<td align="right">0.000</td>
<td align="right">0.000</td>
</tr>
<tr class="odd">
<td align="left">nbr.na</td>
<td align="right">915.000</td>
<td align="right">886.000</td>
<td align="right">396.000</td>
<td align="right">912.000</td>
<td align="right">933.000</td>
<td align="right">868.000</td>
<td align="right">904.000</td>
</tr>
<tr class="even">
<td align="left">min</td>
<td align="right">1.462</td>
<td align="right">3.141</td>
<td align="right">2.490</td>
<td align="right">2.066</td>
<td align="right">1.064</td>
<td align="right">1.515</td>
<td align="right">2.256</td>
</tr>
<tr class="odd">
<td align="left">max</td>
<td align="right">9.562</td>
<td align="right">60.751</td>
<td align="right">52.507</td>
<td align="right">36.299</td>
<td align="right">12.963</td>
<td align="right">11.261</td>
<td align="right">13.505</td>
</tr>
<tr class="even">
<td align="left">range</td>
<td align="right">8.100</td>
<td align="right">57.609</td>
<td align="right">50.018</td>
<td align="right">34.233</td>
<td align="right">11.899</td>
<td align="right">9.746</td>
<td align="right">11.249</td>
</tr>
<tr class="odd">
<td align="left">sum</td>
<td align="right">295.867</td>
<td align="right">2646.551</td>
<td align="right">5214.286</td>
<td align="right">838.415</td>
<td align="right">252.108</td>
<td align="right">619.266</td>
<td align="right">372.010</td>
</tr>
<tr class="even">
<td align="left">median</td>
<td align="right">5.476</td>
<td align="right">30.457</td>
<td align="right">7.880</td>
<td align="right">10.881</td>
<td align="right">6.854</td>
<td align="right">6.053</td>
<td align="right">5.380</td>
</tr>
<tr class="odd">
<td align="left">mean</td>
<td align="right">5.479</td>
<td align="right">31.886</td>
<td align="right">9.100</td>
<td align="right">14.709</td>
<td align="right">7.003</td>
<td align="right">6.131</td>
<td align="right">5.723</td>
</tr>
<tr class="even">
<td align="left">SE.mean</td>
<td align="right">0.233</td>
<td align="right">1.574</td>
<td align="right">0.230</td>
<td align="right">1.373</td>
<td align="right">0.471</td>
<td align="right">0.172</td>
<td align="right">0.264</td>
</tr>
<tr class="odd">
<td align="left">CI.mean.0.95</td>
<td align="right">0.467</td>
<td align="right">3.131</td>
<td align="right">0.452</td>
<td align="right">2.751</td>
<td align="right">0.956</td>
<td align="right">0.341</td>
<td align="right">0.528</td>
</tr>
<tr class="even">
<td align="left">var</td>
<td align="right">2.929</td>
<td align="right">205.556</td>
<td align="right">30.285</td>
<td align="right">107.523</td>
<td align="right">7.983</td>
<td align="right">2.980</td>
<td align="right">4.545</td>
</tr>
<tr class="odd">
<td align="left">std.dev</td>
<td align="right">1.712</td>
<td align="right">14.337</td>
<td align="right">5.503</td>
<td align="right">10.369</td>
<td align="right">2.825</td>
<td align="right">1.726</td>
<td align="right">2.132</td>
</tr>
<tr class="even">
<td align="left">coef.var</td>
<td align="right">0.312</td>
<td align="right">0.450</td>
<td align="right">0.605</td>
<td align="right">0.705</td>
<td align="right">0.403</td>
<td align="right">0.282</td>
<td align="right">0.372</td>
</tr>
<tr class="odd">
<td align="left">skewness</td>
<td align="right">0.005</td>
<td align="right">0.067</td>
<td align="right">3.320</td>
<td align="right">0.633</td>
<td align="right">0.322</td>
<td align="right">0.124</td>
<td align="right">1.042</td>
</tr>
<tr class="even">
<td align="left">skew.2SE</td>
<td align="right">0.008</td>
<td align="right">0.127</td>
<td align="right">16.266</td>
<td align="right">1.001</td>
<td align="right">0.410</td>
<td align="right">0.258</td>
<td align="right">1.753</td>
</tr>
<tr class="odd">
<td align="left">kurtosis</td>
<td align="right">-0.391</td>
<td align="right">-0.825</td>
<td align="right">15.143</td>
<td align="right">-1.009</td>
<td align="right">-0.142</td>
<td align="right">0.220</td>
<td align="right">1.441</td>
</tr>
<tr class="even">
<td align="left">kurt.2SE</td>
<td align="right">-0.306</td>
<td align="right">-0.789</td>
<td align="right">37.156</td>
<td align="right">-0.810</td>
<td align="right">-0.093</td>
<td align="right">0.231</td>
<td align="right">1.229</td>
</tr>
<tr class="odd">
<td align="left">normtest.W</td>
<td align="right">0.991</td>
<td align="right">0.980</td>
<td align="right">0.684</td>
<td align="right">0.889</td>
<td align="right">0.965</td>
<td align="right">0.993</td>
<td align="right">0.937</td>
</tr>
<tr class="even">
<td align="left">normtest.p</td>
<td align="right">0.954</td>
<td align="right">0.239</td>
<td align="right">0.000</td>
<td align="right">0.000</td>
<td align="right">0.310</td>
<td align="right">0.886</td>
<td align="right">0.002</td>
</tr>
</tbody>
</table></div>
<p>We can set a <em>p &lt; .01</em> threshold, which is reasonable for the number of cases in the dataset (hundreds, at least for some of the 2011OAC supergroups). We can claim that <code>leic_2011OAC_20to24</code> is normally distributed in the supergroups Suburbanites (SU), Cosmopolitans (CP), Constrained City Dwellers (CD) and Hard-Pressed Living (HP), as the <code>normtest.p</code> value is above <code>0.01</code>, which allows us to reject the null hypothesis. The variable <code>leic_2011OAC_20to24</code> seems instead not to be normally distributed for Multicultural Metropolitans (MM), Ethnicity Central (EC) and Urbanites (UR). That is also further illustrated by the graphs below.</p>
<div class="sourceCode" id="cb456"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leic_2011OAC_20to24</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">supgrpname</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"SU"</span>, <span class="st">"CP"</span>, <span class="st">"CD"</span>, <span class="st">"HP"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">perc_age_20_to_24</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>      y <span class="op">=</span> <span class="va">..density..</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">supgrpname</span><span class="op">)</span>,</span>
<span>    ncol <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    scales <span class="op">=</span> <span class="st">"free"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Normally distributed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="911-solutions_files/figure-html/unnamed-chunk-34-1.png" width="480"></div>
<div class="sourceCode" id="cb457"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leic_2011OAC_20to24</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">supgrpname</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"MM"</span>, <span class="st">"EC"</span>, <span class="st">"UR"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">perc_age_20_to_24</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>      y <span class="op">=</span> <span class="va">..density..</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">supgrpname</span><span class="op">)</span>,</span>
<span>    ncol <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    scales <span class="op">=</span> <span class="st">"free"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Not normally distributed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="911-solutions_files/figure-html/unnamed-chunk-35-1.png" width="480"></div>
<p><strong>Question 202.1.2:</strong> Write the code necessary to test again the normality of <code>leic_2011OAC_20to24</code> for the supergroups where the analysis conducted for Question 202.1.1 indicated they are normal, using the function <code>shapiro.test</code>, and draw the respective Q-Q plot.</p>
<p>Example for Hard-Pressed Living (HP).</p>
<div class="sourceCode" id="cb458"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leic_2011OAC_20to24</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">supgrpname</span> <span class="op">==</span> <span class="st">"HP"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">perc_age_20_to_24</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  .
## W = 0.99303, p-value = 0.8863</code></pre>
<div class="sourceCode" id="cb460"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leic_2011OAC_20to24</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">supgrpname</span> <span class="op">==</span> <span class="st">"HP"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>      sample <span class="op">=</span> <span class="va">perc_age_20_to_24</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html">stat_qq</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html">stat_qq_line</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="911-solutions_files/figure-html/unnamed-chunk-37-1.png" width="672"></div>
<p><strong>Question 202.1.3:</strong> Observe the output of the Levene’s test executed below. What does the result tell you about the variance of <code>perc_age_20_to_24</code> in supergroups?</p>
<p>Note that the <code>leveneTest</code> was not designed to work with a Tidyverse approach. As such, the code below uses <a href="https://magrittr.tidyverse.org/#the-argument-placeholder">the <code>.</code> argument placeholder</a> to specify that the input table <code>leic_2011OAC_20to24</code> which is coming down from the pipe should be used as argument for the <code>data</code> parameter.</p>
<div class="sourceCode" id="cb461"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leic_2011OAC_20to24</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/car/man/leveneTest.html">leveneTest</a></span><span class="op">(</span></span>
<span>    <span class="va">perc_age_20_to_24</span> <span class="op">~</span> <span class="va">supgrpname</span>, </span>
<span>    data <span class="op">=</span> <span class="va">.</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code>## Levene's Test for Homogeneity of Variance (center = median)
##        Df F value    Pr(&gt;F)    
## group   6  62.011 &lt; 2.2e-16 ***
##       962                      
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<p>If significant, the Levene’s test indicates that the variance is different in different levels. As before, we can set a <em>p &lt; .01</em> threshold. In the output above, the <em>p</em> value (<code>Pr(&gt;F)</code>) is much lower than our threshold, indicating that the test is significance. Thus, the <code>perc_age_20_to_24</code> has different variance for different 2011OAc supergroups.</p>
</div>
</div>
<div id="solutions-203" class="section level2 unnumbered">
<h2>Solutions 203<a class="anchor" aria-label="anchor" href="#solutions-203"><i class="fas fa-link"></i></a>
</h2>
<div id="solutions-203.1" class="section level3 unnumbered">
<h3>Solutions 203.1<a class="anchor" aria-label="anchor" href="#solutions-203.1"><i class="fas fa-link"></i></a>
</h3>
<p>Create a new RMarkdown document, and add the code necessary to oad the <code>2011_OAC_Raw_uVariables_Leicester.csv</code> dataset.</p>
<div class="sourceCode" id="cb463"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org">magrittr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/">knitr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/phgrosjean/pastecs">pastecs</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">leicester_2011OAC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"2011_OAC_Raw_uVariables_Leicester.csv"</span><span class="op">)</span></span></code></pre></div>
<p><strong>Question 203.1.1:</strong> Check whether the values of mean age (<code>u020</code>) are normally distributed, and whether they can be transformed into a normally distributed set using logarithmic or inverse hyperbolic sine functions.</p>
<p>Start from exploring the variable distribution.</p>
<div class="sourceCode" id="cb464"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leicester_2011OAC</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">u020</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<div class="inline-figure"><img src="911-solutions_files/figure-html/unnamed-chunk-41-1.png" width="672"></div>
<div class="sourceCode" id="cb466"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leicester_2011OAC</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>    sample <span class="op">=</span> <span class="va">u020</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html">stat_qq</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html">stat_qq_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="911-solutions_files/figure-html/unnamed-chunk-42-1.png" width="672"></div>
<div class="sourceCode" id="cb467"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leicester_2011OAC</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">u020</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  .
## W = 0.9663, p-value = 3.476e-14</code></pre>
<p>The variable <code>u020</code> is clearly not normally distributed, probably mostly due to a long tail on the right side.</p>
<p>Thus, we can try transform the variable using a logarithmic transformation or a inverse hyperbolic sine transformation. Let’s try both.</p>
<div class="sourceCode" id="cb469"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leicester_2011OAC_trans</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">leicester_2011OAC</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    log10_u020 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">u020</span><span class="op">)</span>,</span>
<span>    ihs_u020 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Hyperbolic.html">asinh</a></span><span class="op">(</span><span class="va">u020</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb470"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leicester_2011OAC_trans</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>    sample <span class="op">=</span> <span class="va">log10_u020</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html">stat_qq</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html">stat_qq_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="911-solutions_files/figure-html/unnamed-chunk-45-1.png" width="672"></div>
<div class="sourceCode" id="cb471"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leicester_2011OAC_trans</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">log10_u020</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<div class="inline-figure"><img src="911-solutions_files/figure-html/unnamed-chunk-46-1.png" width="672"></div>
<div class="sourceCode" id="cb473"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leicester_2011OAC_trans</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">log10_u020</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  .
## W = 0.99474, p-value = 0.001888</code></pre>
<div class="sourceCode" id="cb475"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leicester_2011OAC_trans</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">ihs_u020</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<div class="inline-figure"><img src="911-solutions_files/figure-html/unnamed-chunk-48-1.png" width="672"></div>
<div class="sourceCode" id="cb477"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leicester_2011OAC_trans</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>    sample <span class="op">=</span> <span class="va">ihs_u020</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html">stat_qq</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html">stat_qq_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="911-solutions_files/figure-html/unnamed-chunk-49-1.png" width="672"></div>
<div class="sourceCode" id="cb478"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leicester_2011OAC_trans</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">ihs_u020</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  .
## W = 0.99473, p-value = 0.001874</code></pre>
<p>Even using a logarithmic or inverse hyperbolic sine transformation, the variable <code>u020</code> is still not normally distributed. The <em>p</em>-values are higher compared to the original variable, but still well below the <span class="math inline">\(0.01\)</span> threshold. As visible in the charts, the transformed variables still show some level of long tails on both sides.</p>
<p><strong>Question 203.1.2:</strong> Check whether the values of mean age (<code>u020</code>) are normally distributed when looking at the different 2011OAC supergroups separately. Check whether they can be transformed to a normally distributed set using logarithmic or inverse hyperbolic sine functions.</p>
<p>Note how the code below pivotes the table to obtain one column per 2011OAC supergroup.</p>
<div class="sourceCode" id="cb480"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leicester_2011OAC</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">OA11CD</span>, <span class="va">supgrpname</span>, <span class="va">u020</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span></span>
<span>    id_cols <span class="op">=</span> <span class="va">OA11CD</span>,</span>
<span>    names_from <span class="op">=</span> <span class="va">supgrpname</span>,</span>
<span>    names_prefix <span class="op">=</span> <span class="st">"u020 "</span>,</span>
<span>    values_from <span class="op">=</span> <span class="va">u020</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">OA11CD</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pastecs/man/stat.desc.html">stat.desc</a></span><span class="op">(</span></span>
<span>    basic <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    desc <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    norm <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="6%">
<col width="10%">
<col width="10%">
<col width="18%">
<col width="13%">
<col width="17%">
<col width="14%">
<col width="8%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="right">u020 Suburbanites</th>
<th align="right">u020 Cosmopolitans</th>
<th align="right">u020 Multicultural Metropolitans</th>
<th align="right">u020 Ethnicity Central</th>
<th align="right">u020 Constrained City Dwellers</th>
<th align="right">u020 Hard-Pressed Living</th>
<th align="right">u020 Urbanites</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">skewness</td>
<td align="right">0.83</td>
<td align="right">1.15</td>
<td align="right">0.56</td>
<td align="right">1.81</td>
<td align="right">1.40</td>
<td align="right">1.42</td>
<td align="right">1.04</td>
</tr>
<tr class="even">
<td align="left">skew.2SE</td>
<td align="right">1.27</td>
<td align="right">2.17</td>
<td align="right">2.76</td>
<td align="right">2.87</td>
<td align="right">1.78</td>
<td align="right">2.96</td>
<td align="right">1.74</td>
</tr>
<tr class="odd">
<td align="left">kurtosis</td>
<td align="right">1.24</td>
<td align="right">1.54</td>
<td align="right">0.64</td>
<td align="right">6.13</td>
<td align="right">1.74</td>
<td align="right">2.77</td>
<td align="right">3.56</td>
</tr>
<tr class="even">
<td align="left">kurt.2SE</td>
<td align="right">0.97</td>
<td align="right">1.47</td>
<td align="right">1.58</td>
<td align="right">4.92</td>
<td align="right">1.14</td>
<td align="right">2.91</td>
<td align="right">3.04</td>
</tr>
<tr class="odd">
<td align="left">normtest.W</td>
<td align="right">0.96</td>
<td align="right">0.91</td>
<td align="right">0.98</td>
<td align="right">0.87</td>
<td align="right">0.86</td>
<td align="right">0.89</td>
<td align="right">0.92</td>
</tr>
<tr class="even">
<td align="left">normtest.p</td>
<td align="right">0.07</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
</tr>
</tbody>
</table></div>
<div class="sourceCode" id="cb481"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leicester_2011OAC_trans</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">OA11CD</span>, <span class="va">supgrpname</span>, <span class="va">log10_u020</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span></span>
<span>    id_cols <span class="op">=</span> <span class="va">OA11CD</span>,</span>
<span>    names_from <span class="op">=</span> <span class="va">supgrpname</span>,</span>
<span>    names_prefix <span class="op">=</span> <span class="st">"log10 u020 "</span>,</span>
<span>    values_from <span class="op">=</span> <span class="va">log10_u020</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">OA11CD</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pastecs/man/stat.desc.html">stat.desc</a></span><span class="op">(</span></span>
<span>    basic <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    desc <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    norm <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="5%">
<col width="11%">
<col width="11%">
<col width="17%">
<col width="13%">
<col width="17%">
<col width="14%">
<col width="9%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="right">log10 u020 Suburbanites</th>
<th align="right">log10 u020 Cosmopolitans</th>
<th align="right">log10 u020 Multicultural Metropolitans</th>
<th align="right">log10 u020 Ethnicity Central</th>
<th align="right">log10 u020 Constrained City Dwellers</th>
<th align="right">log10 u020 Hard-Pressed Living</th>
<th align="right">log10 u020 Urbanites</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">skewness</td>
<td align="right">0.46</td>
<td align="right">0.51</td>
<td align="right">0.14</td>
<td align="right">0.88</td>
<td align="right">0.94</td>
<td align="right">0.81</td>
<td align="right">0.21</td>
</tr>
<tr class="even">
<td align="left">skew.2SE</td>
<td align="right">0.71</td>
<td align="right">0.97</td>
<td align="right">0.69</td>
<td align="right">1.39</td>
<td align="right">1.20</td>
<td align="right">1.69</td>
<td align="right">0.35</td>
</tr>
<tr class="odd">
<td align="left">kurtosis</td>
<td align="right">0.44</td>
<td align="right">0.23</td>
<td align="right">0.01</td>
<td align="right">1.77</td>
<td align="right">0.36</td>
<td align="right">1.14</td>
<td align="right">1.78</td>
</tr>
<tr class="even">
<td align="left">kurt.2SE</td>
<td align="right">0.34</td>
<td align="right">0.22</td>
<td align="right">0.01</td>
<td align="right">1.42</td>
<td align="right">0.23</td>
<td align="right">1.19</td>
<td align="right">1.51</td>
</tr>
<tr class="odd">
<td align="left">normtest.W</td>
<td align="right">0.98</td>
<td align="right">0.97</td>
<td align="right">1.00</td>
<td align="right">0.95</td>
<td align="right">0.92</td>
<td align="right">0.95</td>
<td align="right">0.95</td>
</tr>
<tr class="even">
<td align="left">normtest.p</td>
<td align="right">0.64</td>
<td align="right">0.04</td>
<td align="right">0.51</td>
<td align="right">0.02</td>
<td align="right">0.02</td>
<td align="right">0.00</td>
<td align="right">0.02</td>
</tr>
</tbody>
</table></div>
<div class="sourceCode" id="cb482"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leicester_2011OAC_trans</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">OA11CD</span>, <span class="va">supgrpname</span>, <span class="va">ihs_u020</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span></span>
<span>    id_cols <span class="op">=</span> <span class="va">OA11CD</span>,</span>
<span>    names_from <span class="op">=</span> <span class="va">supgrpname</span>,</span>
<span>    names_prefix <span class="op">=</span> <span class="st">"ihs u020 "</span>,</span>
<span>    values_from <span class="op">=</span> <span class="va">ihs_u020</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">OA11CD</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pastecs/man/stat.desc.html">stat.desc</a></span><span class="op">(</span></span>
<span>    basic <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    desc <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    norm <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="5%">
<col width="10%">
<col width="11%">
<col width="18%">
<col width="13%">
<col width="17%">
<col width="14%">
<col width="9%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="right">ihs u020 Suburbanites</th>
<th align="right">ihs u020 Cosmopolitans</th>
<th align="right">ihs u020 Multicultural Metropolitans</th>
<th align="right">ihs u020 Ethnicity Central</th>
<th align="right">ihs u020 Constrained City Dwellers</th>
<th align="right">ihs u020 Hard-Pressed Living</th>
<th align="right">ihs u020 Urbanites</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">skewness</td>
<td align="right">0.46</td>
<td align="right">0.51</td>
<td align="right">0.14</td>
<td align="right">0.88</td>
<td align="right">0.94</td>
<td align="right">0.81</td>
<td align="right">0.21</td>
</tr>
<tr class="even">
<td align="left">skew.2SE</td>
<td align="right">0.71</td>
<td align="right">0.97</td>
<td align="right">0.69</td>
<td align="right">1.39</td>
<td align="right">1.20</td>
<td align="right">1.69</td>
<td align="right">0.36</td>
</tr>
<tr class="odd">
<td align="left">kurtosis</td>
<td align="right">0.44</td>
<td align="right">0.23</td>
<td align="right">0.01</td>
<td align="right">1.78</td>
<td align="right">0.36</td>
<td align="right">1.14</td>
<td align="right">1.78</td>
</tr>
<tr class="even">
<td align="left">kurt.2SE</td>
<td align="right">0.34</td>
<td align="right">0.22</td>
<td align="right">0.01</td>
<td align="right">1.43</td>
<td align="right">0.23</td>
<td align="right">1.19</td>
<td align="right">1.51</td>
</tr>
<tr class="odd">
<td align="left">normtest.W</td>
<td align="right">0.98</td>
<td align="right">0.97</td>
<td align="right">1.00</td>
<td align="right">0.95</td>
<td align="right">0.92</td>
<td align="right">0.95</td>
<td align="right">0.95</td>
</tr>
<tr class="even">
<td align="left">normtest.p</td>
<td align="right">0.64</td>
<td align="right">0.04</td>
<td align="right">0.51</td>
<td align="right">0.02</td>
<td align="right">0.02</td>
<td align="right">0.00</td>
<td align="right">0.02</td>
</tr>
</tbody>
</table></div>
<p>While the original <code>u020</code> variable is only normally distributed (using a <span class="math inline">\(0.01\)</span> threshold) for the <em>Suburbanites</em> supergroup, the transformed variables are normally distributed for all supergroups except <em>Hard-Pressed Living</em>.</p>
<p><strong>Question 203.1.3:</strong> Is the distribution of mean age (<code>u020</code>) different in different 2011OAC supergroups in Leicester?</p>
<p>We use the variable transformed using a logarithmic transformation (which is easier to interpret than an inverse hyperbolic sine) and excluding the <em>Hard-Pressed Living</em> supergroup, to ensure that all groups taken into account are normally distributed. We can then test that using ANOVA.</p>
<p>Let’s start with a boxplot, which can also be horizontal, if the nominal variable (categories) is provides for the <code>y</code> aesthetic and the continuous variable is provides for the <code>x</code> aesthetic. In the example below, that choice makes the 2011OAC supergroup names easier to read.</p>
<div class="sourceCode" id="cb483"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leicester_2011OAC_trans</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">OA11CD</span>, <span class="va">supgrpname</span>, <span class="va">log10_u020</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">supgrpname</span> <span class="op">!=</span> <span class="st">"Hard-Pressed Living"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">log10_u020</span>, </span>
<span>      y <span class="op">=</span> <span class="va">supgrpname</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="911-solutions_files/figure-html/unnamed-chunk-54-1.png" width="672"></div>
<div class="sourceCode" id="cb484"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">log10_u020_supgrpname_aov</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">leicester_2011OAC_trans</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">OA11CD</span>, <span class="va">supgrpname</span>, <span class="va">log10_u020</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">supgrpname</span> <span class="op">!=</span> <span class="st">"Hard-Pressed Living"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/exposition.html">%$%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">log10_u020</span> <span class="op">~</span> <span class="va">supgrpname</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">log10_u020_supgrpname_aov</span></span></code></pre></div>
<pre><code>##              Df Sum Sq Mean Sq F value Pr(&gt;F)    
## supgrpname    5  1.049 0.20988   51.91 &lt;2e-16 ***
## Residuals   862  3.485 0.00404                   
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<p>The test is significant <em>F</em>(5, 862) = 51.91 with <em>p</em> &lt; .01, thus we can say that the distribution of <code>u020</code> across the 2011OAC supergroups, excluding <em>Hard-Pressed Living</em>, are different.</p>
</div>
<div id="solutions-203.2" class="section level3 unnumbered">
<h3>Solutions 203.2<a class="anchor" aria-label="anchor" href="#solutions-203.2"><i class="fas fa-link"></i></a>
</h3>
<p><strong>Question 203.2.1:</strong> As mentioned above, when discussing movement in cities, there is an assumption that people living in the city centre live in flats and work or cycle to work, whereas people living in the suburbs live in whole houses and commute via car. Study the correlation between the presence of flats (<code>u089</code>) and people commuting to work on foot, bicycle or other similar means (<code>u122</code>) in the same OAs. Consider whether the values might need to be normalised or otherwised transformed before starting the testing procedure.</p>
<p>The first necessary step is to normalise the data using the variable statistical unit <code>Total_Household_Spaces</code> for <code>u089</code> and <code>Total_Pop_No_NI_Students_16_to_74</code> for <code>u122</code> as suggested by the lookup table.</p>
<div class="sourceCode" id="cb486"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">flats_commuting</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">leicester_2011OAC</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    u089n <span class="op">=</span> <span class="op">(</span><span class="va">u089</span> <span class="op">/</span> <span class="va">Total_Household_Spaces</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>,</span>
<span>    u122n <span class="op">=</span> <span class="op">(</span><span class="va">u122</span> <span class="op">/</span> <span class="va">Total_Pop_No_NI_Students_16_to_74</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">OA11CD</span>, <span class="va">u089n</span>, <span class="va">u122n</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb487"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">flats_commuting</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">u089n</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<div class="inline-figure"><img src="911-solutions_files/figure-html/unnamed-chunk-57-1.png" width="672"></div>
<div class="sourceCode" id="cb489"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">flats_commuting</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">u122n</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<div class="inline-figure"><img src="911-solutions_files/figure-html/unnamed-chunk-58-1.png" width="672"></div>
<div class="sourceCode" id="cb491"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">flats_commuting</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">u089n</span>, <span class="va">u122n</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pastecs/man/stat.desc.html">stat.desc</a></span><span class="op">(</span></span>
<span>    basic <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    desc <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    norm <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left"></th>
<th align="right">u089n</th>
<th align="right">u122n</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">skewness</td>
<td align="right">1.56</td>
<td align="right">0.85</td>
</tr>
<tr class="even">
<td align="left">skew.2SE</td>
<td align="right">9.94</td>
<td align="right">5.40</td>
</tr>
<tr class="odd">
<td align="left">kurtosis</td>
<td align="right">1.33</td>
<td align="right">0.85</td>
</tr>
<tr class="even">
<td align="left">kurt.2SE</td>
<td align="right">4.23</td>
<td align="right">2.72</td>
</tr>
<tr class="odd">
<td align="left">normtest.W</td>
<td align="right">0.74</td>
<td align="right">0.96</td>
</tr>
<tr class="even">
<td align="left">normtest.p</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
</tr>
</tbody>
</table></div>
<p>The two plots and the table above indicate that the two variables are not normally distributed and left skewed. As such, we can try to apply a logarithmic transformation to both to try to <em>“un-skew”</em> them. Note how <code>rename_with</code> uses a <a href="https://purrr.tidyverse.org/articles/other-langs.html">purrr-style lamba</a> shorthand to to paste <code>log10_</code> in front of all column names.</p>
<div class="sourceCode" id="cb492"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">flats_commuting</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">u089n</span>, <span class="va">u122n</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      <span class="va">log10</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename_with</a></span><span class="op">(</span></span>
<span>    <span class="co"># this is a shorthand</span></span>
<span>    <span class="co"># to paste log10_ in front</span></span>
<span>    <span class="co"># of all column names</span></span>
<span>    <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"log10_"</span>, <span class="va">.x</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pastecs/man/stat.desc.html">stat.desc</a></span><span class="op">(</span></span>
<span>    basic <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    desc <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    norm <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left"></th>
<th align="right">log10_u089n</th>
<th align="right">log10_u122n</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">skewness</td>
<td align="right">NaN</td>
<td align="right">-0.59</td>
</tr>
<tr class="even">
<td align="left">skew.2SE</td>
<td align="right">NaN</td>
<td align="right">-3.73</td>
</tr>
<tr class="odd">
<td align="left">kurtosis</td>
<td align="right">NaN</td>
<td align="right">0.63</td>
</tr>
<tr class="even">
<td align="left">kurt.2SE</td>
<td align="right">NaN</td>
<td align="right">2.01</td>
</tr>
<tr class="odd">
<td align="left">normtest.W</td>
<td align="right">NaN</td>
<td align="right">0.98</td>
</tr>
<tr class="even">
<td align="left">normtest.p</td>
<td align="right">NaN</td>
<td align="right">0.00</td>
</tr>
</tbody>
</table></div>
<p>The presence of <code>NaN</code> values in the <code>u089</code> column indicates that the variable includes zeros, for which the logarithm is not defined. As such, we can try using the inverse iperbolic sine.</p>
<div class="sourceCode" id="cb493"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">flats_commuting</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">u089n</span>, <span class="va">u122n</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      <span class="va">asinh</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename_with</a></span><span class="op">(</span></span>
<span>    <span class="co"># this is a shorthand</span></span>
<span>    <span class="co"># to paste ihs_ in front</span></span>
<span>    <span class="co"># of all column names</span></span>
<span>    <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"ihs_"</span>, <span class="va">.x</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pastecs/man/stat.desc.html">stat.desc</a></span><span class="op">(</span></span>
<span>    basic <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    desc <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    norm <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left"></th>
<th align="right">ihs_u089n</th>
<th align="right">ihs_u122n</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">skewness</td>
<td align="right">-0.09</td>
<td align="right">-0.53</td>
</tr>
<tr class="even">
<td align="left">skew.2SE</td>
<td align="right">-0.59</td>
<td align="right">-3.40</td>
</tr>
<tr class="odd">
<td align="left">kurtosis</td>
<td align="right">-1.10</td>
<td align="right">0.43</td>
</tr>
<tr class="even">
<td align="left">kurt.2SE</td>
<td align="right">-3.51</td>
<td align="right">1.36</td>
</tr>
<tr class="odd">
<td align="left">normtest.W</td>
<td align="right">0.96</td>
<td align="right">0.98</td>
</tr>
<tr class="even">
<td align="left">normtest.p</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
</tr>
</tbody>
</table></div>
<p>The values are now not <code>NaN</code>, but still, the variables are not normally distributed. As such, we can not use Pearson’s r correlation, as one of the assumptions is not met. In first instance, we can use Spearman’s rho to assess their correlation.</p>
<div class="sourceCode" id="cb494"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">flats_commuting</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">u089n</span>,</span>
<span>    y <span class="op">=</span> <span class="va">u122n</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="911-solutions_files/figure-html/unnamed-chunk-62-1.png" width="672"></div>
<div class="sourceCode" id="cb495"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">u089n_u122n_spearman</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">flats_commuting</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/exposition.html">%$%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span></span>
<span>    <span class="va">u089n</span>, <span class="va">u122n</span>, </span>
<span>    method <span class="op">=</span> <span class="st">"spearman"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code>## Warning in cor.test.default(u089n, u122n, method = "spearman"): Cannot compute
## exact p-value with ties</code></pre>
<div class="sourceCode" id="cb497"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">u089n_u122n_spearman</span></span></code></pre></div>
<pre><code>## 
##  Spearman's rank correlation rho
## 
## data:  u089n and u122n
## S = 92011434, p-value &lt; 2.2e-16
## alternative hypothesis: true rho is not equal to 0
## sample estimates:
##       rho 
## 0.3932327</code></pre>
<p>The output above includes the warning <code>Warning: Cannot compute exact p-value with ties</code>. As such, we need to check the number of ties in the dataset.</p>
<div class="sourceCode" id="cb499"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">flats_commuting</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">u089n</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">n</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span>wt <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Warning: `wt = n()` is deprecated
## ℹ You can now omit the `wt` argument</code></pre>
<pre><code>## [1] 127</code></pre>
<div class="sourceCode" id="cb502"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">flats_commuting</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">u122n</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">n</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span>wt <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Warning: `wt = n()` is deprecated
## ℹ You can now omit the `wt` argument</code></pre>
<pre><code>## [1] 85</code></pre>
<p>As the number of ties is sizable, the use of Kendall’s tau is advisable.</p>
<div class="sourceCode" id="cb505"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">u089n_u122n_kendall</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">flats_commuting</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/exposition.html">%$%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span></span>
<span>    <span class="va">u089n</span>, <span class="va">u122n</span>, </span>
<span>    method <span class="op">=</span> <span class="st">"kendall"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">u089n_u122n_kendall</span></span></code></pre></div>
<pre><code>## 
##  Kendall's rank correlation tau
## 
## data:  u089n and u122n
## z = 12.534, p-value &lt; 2.2e-16
## alternative hypothesis: true tau is not equal to 0
## sample estimates:
##       tau 
## 0.2696906</code></pre>
<p>The test is significant (<em>p</em> &lt; .01), thus we can say that there is a relationship, which is however extremely weak. The value for tau is 0.27 indicating that the two variables share only 7.3% of variance.</p>
<p><strong>Question 203.2.2:</strong> Another interesting issue to explore is the relationship between car ownership and the use of public transport. Study the correlation between the presence of households owning 2 or more cars or vans (<code>u118</code>) and people commuting to work via public transport (<code>u120</code>) or on foot, bicycle or other similar means (<code>u122</code>) in the same OAs. Consider whether the values might need to be normalised or otherwised transformed before starting the testing procedure.</p>
<p>The procedure is similar to the one seen above. The variable <code>Total_Households</code> should be used to normalise <code>u118</code>. Importantly, as the question specifies <em>people commuting to work via public transport (<code>u120</code>) or on foot, bicycle or other similar means (<code>u122</code>)</em> we also need to sum <code>u120</code> and <code>u122</code> to account for <em>one or the other</em> (as <a href="https://www.ons.gov.uk/census/censustransformationprogramme/questiondevelopment/occupationindustryandtraveltoworkquestiondevelopmentforcensus2021">the answers in the census questions were mutually exclusive</a>, only one mode could be chosen)</p>
<div class="sourceCode" id="cb507"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cas_vs_not_cars</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">leicester_2011OAC</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    u118n <span class="op">=</span> <span class="op">(</span><span class="va">u118</span> <span class="op">/</span> <span class="va">Total_Households</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>,</span>
<span>    u120u122n <span class="op">=</span> <span class="op">(</span><span class="op">(</span><span class="va">u120</span> <span class="op">+</span> <span class="va">u122</span><span class="op">)</span> <span class="op">/</span> <span class="va">Total_Pop_No_NI_Students_16_to_74</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">OA11CD</span>, <span class="va">u118n</span>, <span class="va">u120u122n</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb508"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cas_vs_not_cars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">u118n</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<div class="inline-figure"><img src="911-solutions_files/figure-html/unnamed-chunk-67-1.png" width="672"></div>
<div class="sourceCode" id="cb510"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cas_vs_not_cars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">u120u122n</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<div class="inline-figure"><img src="911-solutions_files/figure-html/unnamed-chunk-68-1.png" width="672"></div>
<div class="sourceCode" id="cb512"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cas_vs_not_cars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">u118n</span>, <span class="va">u120u122n</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pastecs/man/stat.desc.html">stat.desc</a></span><span class="op">(</span></span>
<span>    basic <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    desc <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    norm <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left"></th>
<th align="right">u118n</th>
<th align="right">u120u122n</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">skewness</td>
<td align="right">0.91</td>
<td align="right">0.79</td>
</tr>
<tr class="even">
<td align="left">skew.2SE</td>
<td align="right">5.78</td>
<td align="right">5.02</td>
</tr>
<tr class="odd">
<td align="left">kurtosis</td>
<td align="right">0.46</td>
<td align="right">1.20</td>
</tr>
<tr class="even">
<td align="left">kurt.2SE</td>
<td align="right">1.46</td>
<td align="right">3.83</td>
</tr>
<tr class="odd">
<td align="left">normtest.W</td>
<td align="right">0.93</td>
<td align="right">0.97</td>
</tr>
<tr class="even">
<td align="left">normtest.p</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
</tr>
</tbody>
</table></div>
<p>Again, both variables as not normally distributed. Thus, we can try to use a logarithmic transformation to try <em>“un-skew”</em> them.</p>
<div class="sourceCode" id="cb513"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cas_vs_not_cars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">u118n</span>, <span class="va">u120u122n</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      <span class="va">log10</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename_with</a></span><span class="op">(</span></span>
<span>    <span class="co"># this is a shorthand</span></span>
<span>    <span class="co"># to paste log10_ in front</span></span>
<span>    <span class="co"># of all column names</span></span>
<span>    <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"log10_"</span>, <span class="va">.x</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pastecs/man/stat.desc.html">stat.desc</a></span><span class="op">(</span></span>
<span>    basic <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    desc <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    norm <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left"></th>
<th align="right">log10_u118n</th>
<th align="right">log10_u120u122n</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">skewness</td>
<td align="right">NaN</td>
<td align="right">-0.18</td>
</tr>
<tr class="even">
<td align="left">skew.2SE</td>
<td align="right">NaN</td>
<td align="right">-1.13</td>
</tr>
<tr class="odd">
<td align="left">kurtosis</td>
<td align="right">NaN</td>
<td align="right">0.09</td>
</tr>
<tr class="even">
<td align="left">kurt.2SE</td>
<td align="right">NaN</td>
<td align="right">0.29</td>
</tr>
<tr class="odd">
<td align="left">normtest.W</td>
<td align="right">NaN</td>
<td align="right">1.00</td>
</tr>
<tr class="even">
<td align="left">normtest.p</td>
<td align="right">NaN</td>
<td align="right">0.04</td>
</tr>
</tbody>
</table></div>
<p>Again, <code>u118n</code> includes some zero value, thus producing <code>NaN</code> values in the table above. As such, we can try using the inverse hyperbolic sine.</p>
<div class="sourceCode" id="cb514"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cas_vs_not_cars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">u118n</span>, <span class="va">u120u122n</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      <span class="va">asinh</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename_with</a></span><span class="op">(</span></span>
<span>    <span class="co"># this is a shorthand</span></span>
<span>    <span class="co"># to paste ihs_ in front</span></span>
<span>    <span class="co"># of all column names</span></span>
<span>    <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"ihs_"</span>, <span class="va">.x</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/pastecs/man/stat.desc.html">stat.desc</a></span><span class="op">(</span></span>
<span>    basic <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    desc <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    norm <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left"></th>
<th align="right">ihs_u118n</th>
<th align="right">ihs_u120u122n</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">skewness</td>
<td align="right">-0.95</td>
<td align="right">-0.17</td>
</tr>
<tr class="even">
<td align="left">skew.2SE</td>
<td align="right">-6.02</td>
<td align="right">-1.11</td>
</tr>
<tr class="odd">
<td align="left">kurtosis</td>
<td align="right">1.70</td>
<td align="right">0.09</td>
</tr>
<tr class="even">
<td align="left">kurt.2SE</td>
<td align="right">5.41</td>
<td align="right">0.28</td>
</tr>
<tr class="odd">
<td align="left">normtest.W</td>
<td align="right">0.95</td>
<td align="right">1.00</td>
</tr>
<tr class="even">
<td align="left">normtest.p</td>
<td align="right">0.00</td>
<td align="right">0.04</td>
</tr>
</tbody>
</table></div>
<p>Note how <code>ihs_u120u122n</code> is normally distributed, but <code>ihs_u118n</code> is not normally distributed. So, again we can’t use Pearson’s r correlation, and we resort to use Spearman’s rho.</p>
<div class="sourceCode" id="cb515"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cas_vs_not_cars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">u118n</span>,</span>
<span>    y <span class="op">=</span> <span class="va">u120u122n</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="911-solutions_files/figure-html/unnamed-chunk-72-1.png" width="672"></div>
<div class="sourceCode" id="cb516"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">u118n_u120u122n_spearman</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">cas_vs_not_cars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/exposition.html">%$%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span></span>
<span>    <span class="va">u118n</span>, <span class="va">u120u122n</span>, </span>
<span>    method <span class="op">=</span> <span class="st">"spearman"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code>## Warning in cor.test.default(u118n, u120u122n, method = "spearman"): Cannot
## compute exact p-value with ties</code></pre>
<div class="sourceCode" id="cb518"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">u118n_u120u122n_spearman</span></span></code></pre></div>
<pre><code>## 
##  Spearman's rank correlation rho
## 
## data:  u118n and u120u122n
## S = 217161157, p-value &lt; 2.2e-16
## alternative hypothesis: true rho is not equal to 0
## sample estimates:
##        rho 
## -0.4320643</code></pre>
<p>Note how the Spearman’s rho statistic is negative, indicating an inverse relationship between the to variables. That is a first indication that the more households with 2 or more cars or vans, the fewer people commute to work via public transport or on foot, bicycle or other similar means. However, again, the functions return the warning <code>Warning: Cannot compute exact p-value with ties</code>.</p>
<div class="sourceCode" id="cb520"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cas_vs_not_cars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">u118n</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">n</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span>wt <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Warning: `wt = n()` is deprecated
## ℹ You can now omit the `wt` argument</code></pre>
<pre><code>## [1] 115</code></pre>
<div class="sourceCode" id="cb523"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cas_vs_not_cars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">u120u122n</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">n</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span>wt <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Warning: `wt = n()` is deprecated
## ℹ You can now omit the `wt` argument</code></pre>
<pre><code>## [1] 83</code></pre>
<p>Again, the dataset contains a sizable number of ties, thus the use of Kendall’s tau is advisable.</p>
<div class="sourceCode" id="cb526"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">u118n_u120u122n_kendall</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">cas_vs_not_cars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/exposition.html">%$%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span></span>
<span>    <span class="va">u118n</span>, <span class="va">u120u122n</span>, </span>
<span>    method <span class="op">=</span> <span class="st">"kendall"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">u118n_u120u122n_kendall</span></span></code></pre></div>
<pre><code>## 
##  Kendall's rank correlation tau
## 
## data:  u118n and u120u122n
## z = -14.278, p-value &lt; 2.2e-16
## alternative hypothesis: true tau is not equal to 0
## sample estimates:
##        tau 
## -0.3065051</code></pre>
<p>The test is significant (<em>p</em> &lt; .01), thus we can say that there is an inverse relationship, which is however very weak. The value for tau is -0.307 indicating that the two variables share only 9.4% of variance.</p>
</div>
</div>
<div id="solutions-204" class="section level2 unnumbered">
<h2>Solutions 204<a class="anchor" aria-label="anchor" href="#solutions-204"><i class="fas fa-link"></i></a>
</h2>
<div id="solutions-204.1" class="section level3 unnumbered">
<h3>Solutions 204.1<a class="anchor" aria-label="anchor" href="#solutions-204.1"><i class="fas fa-link"></i></a>
</h3>
<p><strong>Question 204.1.1:</strong> While linear regression modelling does not require the variables to be normally distributed, very skewed variables such as <code>dep_delay</code> and <code>arr_delay</code> might be a significant obstacle to a robust model. Is it possible to build a robust model using <em>“un-skewed”</em> variables?</p>
<p>As both variables, we can use the inverse hyperbolic sine (<code>asinh</code>) to <em>“un-skew”</em> the variables. However, as illustrated by the plot below, that <em>“expands”</em> the area around the origin of the two axis to the point that the linear relationship might be lost.</p>
<div class="sourceCode" id="cb528"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">flights_nov_20</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    ihs_dep_delay <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Hyperbolic.html">asinh</a></span><span class="op">(</span><span class="op">-</span><span class="va">dep_delay</span><span class="op">)</span>,</span>
<span>    ihs_arr_delay <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Hyperbolic.html">asinh</a></span><span class="op">(</span><span class="op">-</span><span class="va">arr_delay</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">ihs_dep_delay</span>, </span>
<span>      y <span class="op">=</span> <span class="va">ihs_arr_delay</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span><span class="op">(</span>ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="911-solutions_files/figure-html/unnamed-chunk-77-1.png" width="672"></div>
<p>We can still try build a model. However, as illustrated below, the relaionship has become very weak, and the model is still not robust.</p>
<div class="sourceCode" id="cb529"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">delay_model_2</span> <span class="op">&lt;-</span> <span class="va">flights_nov_20</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    ihs_dep_delay <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Hyperbolic.html">asinh</a></span><span class="op">(</span><span class="op">-</span><span class="va">dep_delay</span><span class="op">)</span>,</span>
<span>    ihs_arr_delay <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Hyperbolic.html">asinh</a></span><span class="op">(</span><span class="op">-</span><span class="va">arr_delay</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/exposition.html">%$%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">ihs_dep_delay</span> <span class="op">~</span> <span class="va">ihs_arr_delay</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">delay_model_summary_2</span> <span class="op">&lt;-</span> <span class="va">delay_model_2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">delay_model_summary_2</span></span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = ihs_dep_delay ~ ihs_arr_delay)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -5.4610 -1.0106  0.2507  0.9211  4.1417 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    0.39881    0.06441   6.192 8.75e-10 ***
## ihs_arr_delay  0.48274    0.01930  25.006  &lt; 2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 1.885 on 972 degrees of freedom
## Multiple R-squared:  0.3915, Adjusted R-squared:  0.3909 
## F-statistic: 625.3 on 1 and 972 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb531"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">delay_model_2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">rstandard</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  .
## W = 0.96798, p-value = 8.19e-14</code></pre>
<div class="sourceCode" id="cb533"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">delay_model_2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/bptest.html">bptest</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##  studentized Breusch-Pagan test
## 
## data:  .
## BP = 230.08, df = 1, p-value &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb535"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">delay_model_2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/dwtest.html">dwtest</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##  Durbin-Watson test
## 
## data:  .
## DW = 1.7535, p-value = 5.175e-05
## alternative hypothesis: true autocorrelation is greater than 0</code></pre>
<div class="sourceCode" id="cb537"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">delay_model_2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="911-solutions_files/figure-html/unnamed-chunk-82-1.png" width="672"><img src="911-solutions_files/figure-html/unnamed-chunk-82-2.png" width="672"><img src="911-solutions_files/figure-html/unnamed-chunk-82-3.png" width="672"><img src="911-solutions_files/figure-html/unnamed-chunk-82-4.png" width="672"></p>
<p>An alternative approach might be to use a double square root function – i.e., square root of positive values and square root of the opposite of the value for negative values (more on <code>if_else</code> in the coming weeks). However, that seems not to fully resolve the issue.</p>
<div class="sourceCode" id="cb538"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">flights_nov_20</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    sqrt_dep_delay <span class="op">=</span> </span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span></span>
<span>        <span class="va">dep_delay</span> <span class="op">&gt;=</span> <span class="fl">0</span>, </span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">dep_delay</span><span class="op">)</span>, </span>
<span>        <span class="op">(</span><span class="op">-</span><span class="fl">1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">-</span><span class="va">dep_delay</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    sqrt_arr_delay <span class="op">=</span> </span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span></span>
<span>        <span class="va">arr_delay</span> <span class="op">&gt;=</span> <span class="fl">0</span>, </span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">arr_delay</span><span class="op">)</span>, </span>
<span>        <span class="op">(</span><span class="op">-</span><span class="fl">1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">-</span><span class="va">arr_delay</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">sqrt_dep_delay</span>, </span>
<span>      y <span class="op">=</span> <span class="va">sqrt_arr_delay</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span><span class="op">(</span>ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="911-solutions_files/figure-html/unnamed-chunk-83-1.png" width="672"></div>
</div>
<div id="solutions-204.2" class="section level3 unnumbered">
<h3>Solutions 204.2<a class="anchor" aria-label="anchor" href="#solutions-204.2"><i class="fas fa-link"></i></a>
</h3>
<p><strong>Question 204.2.1:</strong> Is it possible to create a model linking housing type (<code>u086</code> to <code>u090</code>) to the number of people commuting to work via public transport (<code>u120</code>) or on foot, bicycle or other similar means (<code>u122</code>) in the same OAs?</p>
<p>There are five variables in the 2011OAC dataset related to housing type and two related to they type of commuting mentioned in the question (listed below). So, the first step is to extract and normalise those while also summing up the two variables related to commuting, as done in previous exercises.</p>
<ul>
<li>
<code>u086</code>: <em>Whole house or bungalow: Detached</em>
</li>
<li>
<code>u087</code>: <em>Whole house or bungalow: Semi-detached</em>
</li>
<li>
<code>u088</code>: <em>Whole house or bungalow: Terraced (including end-terrace)</em>
</li>
<li>
<code>u089</code>: <em>Flats</em>
</li>
<li>
<code>u090</code>: <em>Caravan or other mobile or temporary structure</em>
</li>
<li>
<code>u120</code>: <em>Public Transport</em>
</li>
<li>
<code>u122</code>: <em>On foot, Bicycle or Other</em>
</li>
</ul>
<div class="sourceCode" id="cb539"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leicester_dwellings</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">leicester_2011OAC</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span></span>
<span>    <span class="va">OA11CD</span>, </span>
<span>    <span class="va">Total_Dwellings</span>, </span>
<span>    <span class="va">Total_Pop_No_NI_Students_16_to_74</span>,</span>
<span>    <span class="va">u120</span>, <span class="va">u122</span>,</span>
<span>    <span class="va">u086</span><span class="op">:</span><span class="va">u090</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    <span class="co"># On foot, Bicycle or Other</span></span>
<span>    <span class="co"># + Public Transport</span></span>
<span>    perc_fbpt <span class="op">=</span> </span>
<span>      <span class="op">(</span><span class="op">(</span><span class="va">u120</span> <span class="op">+</span> <span class="va">u122</span><span class="op">)</span> <span class="op">/</span> </span>
<span>         <span class="va">Total_Pop_No_NI_Students_16_to_74</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span> </span>
<span>      <span class="va">u086</span><span class="op">:</span><span class="va">u090</span>,</span>
<span>      <span class="co">#scale</span></span>
<span>      <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span> <span class="op">(</span><span class="va">x</span> <span class="op">/</span> <span class="va">Total_Dwellings</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span> <span class="op">}</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span></span>
<span>    perc_detached <span class="op">=</span> <span class="va">u086</span>,</span>
<span>    perc_semidetached <span class="op">=</span> <span class="va">u087</span>,</span>
<span>    perc_terraced <span class="op">=</span> <span class="va">u088</span>,</span>
<span>    perc_flats <span class="op">=</span> <span class="va">u089</span>,   </span>
<span>    perc_carava_tmp <span class="op">=</span> <span class="va">u090</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Remove columns not needed anymore</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span></span>
<span>    <span class="op">-</span><span class="va">Total_Dwellings</span>, </span>
<span>    <span class="op">-</span><span class="va">Total_Pop_No_NI_Students_16_to_74</span>,</span>
<span>    <span class="op">-</span><span class="va">u120</span>, <span class="op">-</span><span class="va">u122</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">perc_fbpt</span><span class="op">)</span></span></code></pre></div>
<p>We can then explore the relationships between the variables using a pairs panel.</p>
<div class="sourceCode" id="cb540"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggobi.github.io/ggally/">GGally</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">leicester_dwellings</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">perc_fbpt</span>,<span class="va">perc_detached</span><span class="op">:</span><span class="va">perc_carava_tmp</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">GGally</span><span class="fu">::</span><span class="fu"><a href="https://ggobi.github.io/ggally/reference/ggpairs.html">ggpairs</a></span><span class="op">(</span></span>
<span>    upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>continuous <span class="op">=</span> <span class="fu"><a href="https://ggobi.github.io/ggally/reference/wrap.html">wrap</a></span><span class="op">(</span><span class="va">ggally_cor</span>, method <span class="op">=</span> <span class="st">"kendall"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>continuous <span class="op">=</span> <span class="fu"><a href="https://ggobi.github.io/ggally/reference/wrap.html">wrap</a></span><span class="op">(</span><span class="st">"points"</span>, alpha <span class="op">=</span> <span class="fl">0.3</span>, size<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="911-solutions_files/figure-html/unnamed-chunk-86-1.png" width="672"></div>
<p>The plot above illustrates how the variable related to commuting via foot, bicycle or public transport in Leicester is very skewed. The same applies to the variables related to housing type. At the same time, the presence of <em>Caravan or other mobile or temporary structure</em> seems minimal. As such, we can attempt to remove the latter, and <em>“un-skew”</em> the rest using a logarithmic function. As there are cases in which at least one of the variables has minimum zero, we can take this example to explore the use of the function <span class="math inline">\(log_{10}(x+1)\)</span> – which shift the logaritmic function to the left, so that the result is zero for <span class="math inline">\(x=0\)</span>.</p>
<div class="sourceCode" id="cb541"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leicester_dwellings</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/compound.html">%&lt;&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">perc_fbpt</span>,<span class="va">perc_detached</span><span class="op">:</span><span class="va">perc_flats</span><span class="op">)</span>,</span>
<span>      <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">.x</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename_with</a></span><span class="op">(</span></span>
<span>    <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"log_"</span>, <span class="va">.x</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">perc_fbpt</span>,<span class="va">perc_detached</span><span class="op">:</span><span class="va">perc_flats</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb542"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leicester_dwellings</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">log_perc_fbpt</span>,<span class="va">log_perc_detached</span><span class="op">:</span><span class="va">log_perc_flats</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">GGally</span><span class="fu">::</span><span class="fu"><a href="https://ggobi.github.io/ggally/reference/ggpairs.html">ggpairs</a></span><span class="op">(</span></span>
<span>    upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>continuous <span class="op">=</span> <span class="fu"><a href="https://ggobi.github.io/ggally/reference/wrap.html">wrap</a></span><span class="op">(</span><span class="va">ggally_cor</span>, method <span class="op">=</span> <span class="st">"kendall"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>continuous <span class="op">=</span> <span class="fu"><a href="https://ggobi.github.io/ggally/reference/wrap.html">wrap</a></span><span class="op">(</span><span class="st">"points"</span>, alpha <span class="op">=</span> <span class="fl">0.3</span>, size<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="911-solutions_files/figure-html/unnamed-chunk-88-1.png" width="672"></div>
<p>The plot above indicates a somewhat weak linear relationship between commuting via foot, bicycle or public transport and housing types. At the same time, there seems to be a clear relationship between semidetached houses and flats, which indicates a possible case of multicolinearity. Let’s try include all the variables above into a model and double-check multicolinearity.afterwards.</p>
<div class="sourceCode" id="cb543"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create model</span></span>
<span><span class="va">dwellings_model1</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">leicester_dwellings</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/exposition.html">%$%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span></span>
<span>    <span class="va">log_perc_fbpt</span> <span class="op">~</span> </span>
<span>      <span class="va">log_perc_detached</span> <span class="op">+</span> <span class="va">log_perc_semidetached</span> <span class="op">+</span> </span>
<span>      <span class="va">log_perc_terraced</span> <span class="op">+</span> <span class="va">log_perc_flats</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Print summary</span></span>
<span><span class="va">dwellings_model1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log_perc_fbpt ~ log_perc_detached + log_perc_semidetached + 
##     log_perc_terraced + log_perc_flats)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.42849 -0.06348  0.01066  0.06716  0.33209 
## 
## Coefficients:
##                        Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)            1.441188   0.023965  60.136  &lt; 2e-16 ***
## log_perc_detached     -0.097106   0.008704 -11.156  &lt; 2e-16 ***
## log_perc_semidetached -0.071241   0.009176  -7.763 2.10e-14 ***
## log_perc_terraced      0.039661   0.006777   5.852 6.63e-09 ***
## log_perc_flats         0.009618   0.007510   1.281    0.201    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.09989 on 964 degrees of freedom
## Multiple R-squared:  0.3602, Adjusted R-squared:  0.3576 
## F-statistic: 135.7 on 4 and 964 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb545"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dwellings_model1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="911-solutions_files/figure-html/unnamed-chunk-90-1.png" width="672"><img src="911-solutions_files/figure-html/unnamed-chunk-90-2.png" width="672"><img src="911-solutions_files/figure-html/unnamed-chunk-90-3.png" width="672"><img src="911-solutions_files/figure-html/unnamed-chunk-90-4.png" width="672"></p>
<div class="sourceCode" id="cb546"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dwellings_model1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">rstandard</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  .
## W = 0.98718, p-value = 1.722e-07</code></pre>
<div class="sourceCode" id="cb548"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dwellings_model1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/bptest.html">bptest</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##  studentized Breusch-Pagan test
## 
## data:  .
## BP = 83.074, df = 4, p-value &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb550"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dwellings_model1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/dwtest.html">dwtest</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##  Durbin-Watson test
## 
## data:  .
## DW = 0.71231, p-value &lt; 2.2e-16
## alternative hypothesis: true autocorrelation is greater than 0</code></pre>
<div class="sourceCode" id="cb552"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dwellings_model1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/car/man/vif.html">vif</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>##     log_perc_detached log_perc_semidetached     log_perc_terraced 
##              1.313314              1.948536              1.129558 
##        log_perc_flats 
##              1.943342</code></pre>
<p>Interestingly, the results above don’t indicate a sigificant level or multicolinearity. However, the model is not robust. Also, we can see how the variable <code>log_perc_flats</code> is not significant in the model. Thus, we can try remove that variable and see whether there is any improvement.</p>
<div class="sourceCode" id="cb554"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create model</span></span>
<span><span class="va">dwellings_model2</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">leicester_dwellings</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/exposition.html">%$%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span></span>
<span>    <span class="va">log_perc_fbpt</span> <span class="op">~</span> </span>
<span>      <span class="va">log_perc_detached</span> <span class="op">+</span> <span class="va">log_perc_semidetached</span> <span class="op">+</span> </span>
<span>      <span class="va">log_perc_terraced</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Print summary</span></span>
<span><span class="va">dwellings_model2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log_perc_fbpt ~ log_perc_detached + log_perc_semidetached + 
##     log_perc_terraced)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.42751 -0.06284  0.01012  0.06590  0.33884 
## 
## Coefficients:
##                        Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)            1.465339   0.014794  99.047  &lt; 2e-16 ***
## log_perc_detached     -0.099686   0.008471 -11.768  &lt; 2e-16 ***
## log_perc_semidetached -0.078462   0.007243 -10.833  &lt; 2e-16 ***
## log_perc_terraced      0.037686   0.006601   5.709 1.51e-08 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.09992 on 965 degrees of freedom
## Multiple R-squared:  0.3591, Adjusted R-squared:  0.3571 
## F-statistic: 180.3 on 3 and 965 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb556"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dwellings_model2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="911-solutions_files/figure-html/unnamed-chunk-96-1.png" width="672"><img src="911-solutions_files/figure-html/unnamed-chunk-96-2.png" width="672"><img src="911-solutions_files/figure-html/unnamed-chunk-96-3.png" width="672"><img src="911-solutions_files/figure-html/unnamed-chunk-96-4.png" width="672"></p>
<div class="sourceCode" id="cb557"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dwellings_model2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">rstandard</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  .
## W = 0.98751, p-value = 2.413e-07</code></pre>
<div class="sourceCode" id="cb559"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dwellings_model2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/bptest.html">bptest</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##  studentized Breusch-Pagan test
## 
## data:  .
## BP = 80.115, df = 3, p-value &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb561"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dwellings_model2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/dwtest.html">dwtest</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##  Durbin-Watson test
## 
## data:  .
## DW = 0.71123, p-value &lt; 2.2e-16
## alternative hypothesis: true autocorrelation is greater than 0</code></pre>
<div class="sourceCode" id="cb563"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dwellings_model2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/car/man/vif.html">vif</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>##     log_perc_detached log_perc_semidetached     log_perc_terraced 
##              1.242958              1.212989              1.071107</code></pre>
<p>All the variables within the models are now significant. However, the <span class="math inline">\(R^2\)</span> is very low, indicating a very weak model. Moreover, the tests above indicate that the model is not robust.</p>
<p>Thus, we can conclude that, no, it seem like it is not possible to create a model linking population density to housing type in Leicester.</p>
<!--

### Solutions 104.2 {-}

Answer the question below, consulting the [`stringr` library reference (stringr.tidyverse.org/reference)](https://stringr.tidyverse.org/reference/index.html) as necessary

**Question 104.2.1:** Write a piece of code using the pipe operator and the `stringr` library that takes as input the string `"I like programming in R"`, and transforms it all in uppercase.


```r
"I like programming in R" %>%
  # transforms it all in uppercase
  str_to_upper()
```


**Question 104.2.2:** Write a piece of code using the pipe operator and the `stringr` library that takes as input the string `"I like programming in R"`, and truncates it, leaving only 10 characters.


```r
"I like programming in R" %>%
  # truncate leaving only 10 characters
  str_trunc(10)
```


**Question 104.2.3:** Write a piece of code using the pipe operator and the `stringr` library that takes as input the string `"I like programming in R"`, and truncates it, leaving only 10 characters and using no ellipsis.


```r
"I like programming in R" %>%
  # truncate
  str_trunc(
    # leaving only 10 characters
    10,
    # no ellipsis
    ellipsis = ""
  )
```


**Question 104.2.4:** Write a piece of code using the pipe operator and the `stringr` library that takes as input the string `"I like programming in R"`, and manipulates to leave only the string `"I like R"`.


```r
# Option 1
"I like programming in R" %>%
  # using remove
  str_remove("programming in ")

# Option 2
"I like programming in R" %>%
  # using replace
  str_replace("programming in ", "")

# Option 3
"I like programming in R" %>%
  # create two sub-strings
  str_sub(
    # the first starting from the first character
    # the second starting from the last character
    start = c(1, -1),
    # the first ending at the sixth character
    # the secondending at the last character
    end = c(6, -1)
  ) %>% 
  # join the two strings into one
  # using a single space to separate them
  str_c(collapse = " ")

# Option 4
"I like programming in R" %>%
  # split the string at each space
  str_split(" ") %>% 
  # that will create a list with one element
  # that is the vector of strings resulting
  # from the split
  # to extract that element
  # use extract2 from magrittr
  # equivalent to [[1]]
  # https://magrittr.tidyverse.org/reference/aliases.html
  extract2(1) %>%
  # extract the first, second and fifth elements
  # from the vector
  # use extract2 from magrittr
  # equivalent to [c(1, 2, 5)]
  # https://magrittr.tidyverse.org/reference/aliases.html
  extract(c(1, 2, 5)) %>%
  # join the two strings into one
  # using a single space to separate them
  str_c(collapse = " ")
```


## Solutions 114 {-}


```r
# Load the tidyverse
library(tidyverse)
```



### Solutions 114.1 {-}

**Question 114.1.1:** Use the modulo operator `%%` to create a conditional statement that prints `"Even"` if a number is even and `"Odd"` if a number is odd.


```r
number_for_test <- 7

# If a number modulo 2 is 0 then the nuber is even
if (number_for_test %% 2 == 0) {
  cat("Even\n")
# otherwise it is odd
} else {
  cat("Odd\n")
}
```


**Question 114.1.2:** Encapsulate the conditional statement written for *Question 114.1.1* into a `for` loop that executes the conditional statement for all numbers from 1 to 10.


```r
for (iterator in 1:10) {
  if (iterator %% 2 == 0) {
    cat("Even\n")
  } else {
    cat("Odd\n")
  }
  
}
# After the loop delete the iterator
# just to be on the safe side :)
rm(iterator)
```


**Question 114.1.3:** Encapsulate the conditional statement written for *Question 114.1.1* into a `for` loop that prints the name of cities in odd positions (i.e., first, third, fifth) in the vector `c("Birmingham", "Derby", "Leicester", "Lincoln", "Nottingham", "Wolverhampton")`.


```r
cities <- c("Birmingham", "Derby", "Leicester", "Lincoln", "Nottingham", "Wolverhampton")

# for each index in the vecotr cities
# i.e., 1 to length of the vector
for (iterator in 1:length(cities)) {
  # Testing for odd number intead of even
  # thus checking if the result is 1 rather than 0
  if (iterator %% 2 == 1) {
    cat(cities[iterator], "\n")
  }
  
}
# After the loop delete the iterator
# just to be on the safe side :)
rm(iterator)
```

**Question 114.1.4:** Write the code necessary to print the name of the cities in the vector `c("Birmingham", "Derby", "Leicester", "Lincoln", "Nottingham", "Wolverhampton")` as many times as their position in the vector (i.e., once for the first city, two times for the second, and so on and so forth).


```r
# for each index in the vecotr cities
# i.e., 1 to length of the vector
for (iterator in 1:length(cities)) {
  # need a second iterator!
  # to print the name of the city as many 
  # times as 1 to the current value if the iterator above
  for (second_iterator in 1:iterator){
    # Let's keep the city name on the sam line
    # just addid a space between occurencies
    cat(cities[iterator], " ")
  }
  # Once we are done printing one city name
  # then go to new line
  cat("\n")
}
# After the loop delete both iterators
# just to be on the safe side :)
rm(iterator)
rm(second_iterator)
```



### Solutions 114.2 {-}

**Question 114.2.1:** Write a function that calculates the areas of a circle, taking the radius as the first parameter.


```r
area_of_a_circle <- function (circle_radius) {
  # the area of a circle is equal to
  # pi times radius squared
  circle_area <- pi * (circle_radius^2)
  # return the value
  circle_area
}

# Test
area_of_a_circle(3)
```

**Question 114.2.2:** Write a function that calculates the volume of a cylinder, taking the radius of the base as the first parameter and the height as the second parameter. The function should call the function defined above and multiply the returned value by the height to calculate the result.


```r
volume_of_a_cilinder <- function(base_radius, cilinder_height) {
  # call the function defined above to calculate the area
  base_area <- area_of_a_circle(base_radius)
  # then calculate volume
  cilinder_volume <- base_area * cilinder_height
  # return the value
  cilinder_volume
}

# Test
volume_of_a_cilinder(3, 2)
```



**Question 114.2.3:** Write a function with two parameters, a vector of numbers and a vector of characters (text). The function should check that the input has the correct data type. If all the numbers in the first vector are greater than zero, return the elements of the second vector from the first to the length of the first vector. 


```r
silly_function <- function (num_vector, chr_vector) {
  # Check vector types
  # Note that you can use logic operators
  # to combine conditional statements
  # and the function all
  # to check if the condition is true for all the elements of the vector
  if ( all(is.numeric(num_vector)) & all(is.character(chr_vector)) ) {
    # Check if all numbers greater than zero
    if (all(num_vector > 0)){
      # Subset the vector to return
      chr_vector[1:length(num_vector)]
    } else {
      cat("That's low...\n")
    }
  } else {
    cat("Those values seem highly inappropriate!\n")
  }
}

# Test 1
silly_function(1:3, cities)

# Test 3
silly_function(-1:1, cities)

# Test 3
silly_function(cities, 1:3)
```


-->
<hr>
<p><small>by <a href="https://sdesabbata.github.io/">Stefano De Sabbata</a> – text licensed under the <a href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a>, contains public sector information licensed under the <a href="http://www.nationalarchives.gov.uk/doc/open-government-licence">Open Government Licence v3.0</a>, code licensed under the <a href="https://www.gnu.org/licenses/gpl-3.0.html">GNU GPL v3.0</a>.</small></p>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="appendix-1.html">Appendix 1</a></div>
<div class="next"><a href="lecture-slides.html">Lecture slides</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#solutions">Solutions</a></li>
<li>
<a class="nav-link" href="#solutions-101">Solutions 101</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#solutions-101.1">Solutions 101.1</a></li></ul>
</li>
<li>
<a class="nav-link" href="#solutions-102">Solutions 102</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#solutions-102.1">Solutions 102.1</a></li></ul>
</li>
<li>
<a class="nav-link" href="#solutions-103">Solutions 103</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#solutions-103.1">Solutions 103.1</a></li></ul>
</li>
<li>
<a class="nav-link" href="#solutions-104">Solutions 104</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#solutions-104.1">Solutions 104.1</a></li></ul>
</li>
<li>
<a class="nav-link" href="#solutions-201">Solutions 201</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#solutions-201.1">Solutions 201.1</a></li></ul>
</li>
<li>
<a class="nav-link" href="#solutions-202">Solutions 202</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#solutions-202.1">Solutions 202.1</a></li></ul>
</li>
<li>
<a class="nav-link" href="#solutions-203">Solutions 203</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#solutions-203.1">Solutions 203.1</a></li>
<li><a class="nav-link" href="#solutions-203.2">Solutions 203.2</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#solutions-204">Solutions 204</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#solutions-204.1">Solutions 204.1</a></li>
<li><a class="nav-link" href="#solutions-204.2">Solutions 204.2</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/sdesabbata/r-for-geographic-data-science/blob/main/src/book/911-solutions.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/sdesabbata/r-for-geographic-data-science/edit/main/src/book/911-solutions.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>R for Geographic Data Science</strong>" was written by Stefano De Sabbata. It was last built on 2022-11-29.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
